(function(t){function e(e){for(var s,n,r=e[0],a=e[1],h=e[2],d=0,u=[];d<r.length;d++)n=r[d],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&u.push(o[n][0]),o[n]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s]);c&&c(e);while(u.length)u.shift()();return l.push.apply(l,h||[]),i()}function i(){for(var t,e=0;e<l.length;e++){for(var i=l[e],s=!0,r=1;r<i.length;r++){var a=i[r];0!==o[a]&&(s=!1)}s&&(l.splice(e--,1),t=n(n.s=i[0]))}return t}var s={},o={app:0},l=[];function n(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=s,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/OpenWebSheet/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var h=0;h<r.length;h++)e(r[h]);var c=a;l.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("cd49")},"0cfa":function(t,e,i){"use strict";var s=i("fd03"),o=i.n(s);o.a},"19e8":function(t,e,i){},"2d04":function(t,e,i){},"2dae":function(t,e,i){},"44e8":function(t,e,i){},"4e2e":function(t,e,i){"use strict";var s=i("c95a"),o=i.n(s);o.a},"5b4a":function(t,e,i){"use strict";var s=i("9781"),o=i.n(s);o.a},"60d7":function(t,e,i){"use strict";var s=i("bdbe"),o=i.n(s);o.a},6299:function(t,e,i){"use strict";var s=i("7096"),o=i.n(s);o.a},7096:function(t,e,i){},"76a9":function(t,e,i){"use strict";var s=i("44e8"),o=i.n(s);o.a},"7d84":function(t,e,i){},"8c48":function(t,e,i){"use strict";var s=i("2dae"),o=i.n(s);o.a},"912e":function(t,e,i){"use strict";var s=i("19e8"),o=i.n(s);o.a},9781:function(t,e,i){},b619:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Evaluator}));var core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("5319"),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_0__);class Env{constructor(t,e){this.ranges=t,this.dataProvider=e}Eval(txt){var _M_E_=this,_R_A_N_G_E_=this.ranges,PI=Math.PI,E=Math.E;function SUM(t){return _M_E_.data(t).reduce((t,e)=>1*t+1*e,0)}function MIN(t){return _M_E_.data(t).reduce((t,e)=>Math.min(1*t,1*e),0)}function MAX(t){return _M_E_.data(t).reduce((t,e)=>Math.max(1*t,1*e),0)}function SIN(t){return Math.sin(t)}function COS(t){return Math.cos(t)}function TAN(t){return Math.tan(t)}function ASIN(t){return Math.asin(t)}function ACOS(t){return Math.acos(t)}function ATAN(t){return Math.atan(t)}function ASINH(t){return Math.asinh(t)}function ACOSH(t){return Math.acosh(t)}function ATANH(t){return Math.atanh(t)}function ABS(t){return Math.abs(t)}function SQRT(t){return Math.sqrt(t)}function CBRT(t){return Math.cbrt(t)}function LOG(t){return Math.log(t)}function EXP(t){return Math.exp(t)}function TRUNC(t){return Math.trunc(t)}function CEIL(t){return Math.ceil(t)}function FLOOR(t){return Math.floor(t)}return eval(txt)}data(t){return this.dataProvider.getEvaluatedValue(t)}}class Evaluator{static Eval(t,e){if(e.length<1||"="!=e[0])return e;var i,s=this.valueRegex,o=e,l=[],n=0;while(null!==(i=s.exec(e)))i.index===s.lastIndex&&s.lastIndex++,i.forEach((e,i)=>{if(e&&-1!=e.indexOf(":"))l.push(e),o=o.replace(e+"","_R_A_N_G_E_[".concat(n++,"]"));else if(0==i){var s=t.getEvaluatedValue(e);o=o.replace(e,s)}});try{return new Env(l,t).Eval(o.substr(1))}catch(r){return"#ERR"}}}Evaluator.valueRegex=/(([a-zA-Z]+[0-9])+\:?([a-zA-Z]+[0-9]+)?)/g},bdbe:function(t,e,i){},c95a:function(t,e,i){},ca56:function(t,e,i){"use strict";var s=i("7d84"),o=i.n(s);o.a},cd49:function(t,e,i){"use strict";i.r(e);var s=i("a026"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("ribbon-menu",{attrs:{appearance:t.appearance,state:t.state},on:{"mode-changed":t.onModeChanged,action:t.onAction}}),i("formula-bar",{attrs:{label:t.state.label},on:{commit:t.onCommit,abort:t.onAbort},model:{value:t.state.value,callback:function(e){t.$set(t.state,"value",e)},expression:"state.value"}}),i("open-sheet",{ref:"sheet",on:{ready:t.onReady,change:t.onChange}}),i("status-bar")],1)},l=[],n=(i("e260"),i("ddb0"),i("9ab4")),r=i("60a3"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ribbon",{attrs:{menu:t.menu},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[i("div",{attrs:{slot:"menu-home"},slot:"menu-home"},[t.isLocalMode?i("control-box",{attrs:{label:"Local Storage"}},[i("span",{staticStyle:{display:"flex","align-content":"center","flex-direction":"column","align-items":"center"}},[i("i",{staticClass:"far fa-times-circle xx-large-font flat-button",on:{click:function(e){return t.changeMode("file")}}}),i("span",{staticStyle:{padding:"5px"}},[t._v(" Back to file mode ")])])]):i("control-box",{staticClass:"last",attrs:{label:"Document"}},[i("div",{staticStyle:{display:"flex",padding:"10px 5px","text-align":"center"}},[i("i",{staticClass:"fas fa-save x-large-font flat-button",on:{click:function(e){return t.onAction("save-ows")}}}),i("span",{staticClass:"seperator"}),i("i",{staticClass:"fas fa-folder x-large-font flat-button",on:{click:function(e){return t.onAction("load-ows")}}}),i("span",{staticClass:"seperator"}),i("i",{staticClass:"fas fa-warehouse x-large-font flat-button",on:{click:function(e){return t.changeMode("local")}}})])]),i("control-box",{staticClass:"independent",attrs:{label:"Font"}},[i("p",[i("font-family-selector",{model:{value:t.fontFamily,callback:function(e){t.fontFamily=e},expression:"fontFamily"}}),i("font-size-selector",{model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}})],1),i("p",[i("action-group",{staticStyle:{float:"left","margin-right":"15px"},attrs:{value:t.fontStyle},on:{action:t.onAction}},[i("i",{staticClass:"fa fa-bold",attrs:{slot:"bold"},slot:"bold"}),i("i",{staticClass:"fa fa-italic",attrs:{slot:"italic"},slot:"italic"}),i("i",{staticClass:"fa fa-underline",attrs:{slot:"underline"},slot:"underline"})]),i("color-picker",{model:{value:t.foreColor,callback:function(e){t.foreColor=e},expression:"foreColor"}},[i("i",{staticClass:"fas fa-palette"})])],1)]),i("control-box",{staticClass:"last",attrs:{label:"Format"}},[i("p",[i("color-picker",{attrs:{label:"Fill color"},model:{value:t.fillColor,callback:function(e){t.fillColor=e},expression:"fillColor"}},[i("i",{staticClass:"fa fa-fill",attrs:{slot:"prefix"},slot:"prefix"})])],1),i("p",[i("action-group",{attrs:{value:t.textAlignment},on:{action:t.onAlign}},[i("i",{staticClass:"fa fa-align-left",attrs:{slot:"left"},slot:"left"}),i("i",{staticClass:"fa fa-align-center",attrs:{slot:"center"},slot:"center"}),i("i",{staticClass:"fa fa-align-right",attrs:{slot:"right"},slot:"right"})])],1)]),i("control-box",{staticClass:"independent",attrs:{label:"Cell"}},[i("p",[i("action-button",{class:{on:t.state.isMerged},attrs:{label:"Merge"},on:{click:t.toggleMerge}},[i("i",{staticClass:"fa fa-th",attrs:{slot:"prefix"},slot:"prefix"})])],1),i("p",[i("color-picker",{attrs:{label:"Border"},model:{value:t.borderColor,callback:function(e){t.borderColor=e},expression:"borderColor"}})],1)]),i("control-box",{attrs:{label:"Borders"}},[i("cell-border-style",{on:{change:t.onBorderChanged}})],1)],1),i("div",{attrs:{slot:"menu-formulas"},slot:"menu-formulas"},[i("control-box",{staticStyle:{flex:"1"},attrs:{label:"Mathematical"}}),i("control-box",{staticClass:"last",staticStyle:{flex:"1"},attrs:{label:"Statistics"}}),i("control-box",{staticClass:"independent",staticStyle:{flex:"3"},attrs:{label:"User Defined Functions"}})],1),i("div",{attrs:{slot:"menu-data"},slot:"menu-data"},[i("control-box",{attrs:{label:"File"}},[i("div",{staticStyle:{margin:"10px 20px"}},[i("i",{staticClass:"fa fa-file-excel",staticStyle:{"font-size":"xx-large"}})])]),i("control-box",{attrs:{label:"Open Office"}},[i("action-group",{attrs:{value:[{name:"import",label:"Import"},{name:"export",label:"Export"}]}})],1),i("control-box",{staticClass:"last",staticStyle:{flex:"1"},attrs:{label:"MS Excel"}},[i("action-group",{attrs:{value:[{name:"import",label:"Import"},{name:"export",label:"Export"}]}})],1),i("control-box",{staticStyle:{flex:"4"},attrs:{label:"3rd Parties"}})],1),i("div",{attrs:{slot:"menu-view"},slot:"menu-view"},[i("control-box",{attrs:{label:"Print"}},[i("div",{staticStyle:{margin:"5px 20px"}},[i("i",{staticClass:"fa fa-print",staticStyle:{"font-size":"xx-large"}})])]),i("control-box",{staticStyle:{flex:"1"},attrs:{label:"Layout"}})],1),i("div",{staticStyle:{flex:"1"},attrs:{slot:"menu-info"},slot:"menu-info"},[i("control-box",{attrs:{label:"OSI"}},[i("span",{staticStyle:{"font-size":"xx-large",color:"#00454d","font-weight":"bold"}},[i("i",{staticClass:"fab fa-osi"})])]),i("control-box",{staticStyle:{flex:"1"},attrs:{label:"About Open Web Sheet Project",grid:!1}},[i("span",{staticStyle:{flex:"1"}},[t._v(" Designed and developed by "),i("strong",[t._v("Siamand Maroufi")]),i("br"),t._v(" 3rd Parties: "),i("strong",[t._v("FontAwesome Icons")]),t._v(" & "),i("strong",[t._v("Google noto web font")]),i("br"),t._v(" Licence: "),i("strong",[t._v("MIT Licence")])]),i("span",{staticStyle:{"align-self":"flex-start"}},[i("a",{attrs:{href:"https://siamand.cc"}},[i("i",{staticClass:"fa fa-link"}),t._v(" Developer's site")]),t._v(" | "),i("a",{attrs:{href:"https://github.com/SiamandMaroufi/OpenWebSheet"}},[i("i",{staticClass:"fab fa-github"}),t._v(" Source Code")])])])],1)])],1)},h=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ribbon-menu"},[i("ul",{staticClass:"menu",attrs:{"data-qa":"menu"}},t._l(t.menu,(function(e){return i("li",{key:e.name,staticClass:"menu-label",class:{active:t.active===e.name},attrs:{"data-qa":e},on:{click:function(i){t.active=e.name}}},[t._v(" "+t._s(e.label)+" ")])})),0),i("div",{staticClass:"menu-content"},t._l(t.menu,(function(e){return i("div",{key:e.name,staticClass:"menu-content-item",class:{active:t.active===e.name}},[t._t(e.name,[i("fieldset",[i("legend",[t._v(t._s(e.label))]),i("span",{staticClass:"default-place-holder"},[t._v("placeholder for "+t._s(e.name))])])])],2)})),0)])},d=[],u=class extends r["c"]{get active(){return this.value}set active(t){this.$emit("input",t)}};n["a"]([Object(r["b"])({required:!0})],u.prototype,"value",void 0),n["a"]([Object(r["b"])({required:!0})],u.prototype,"menu",void 0),u=n["a"]([Object(r["a"])({name:"Ribbon"})],u);var f=u,m=f,v=(i("d2ec"),i("2877")),g=Object(v["a"])(m,c,d,!1,null,"244e0240",null),p=g.exports,C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"control-box",attrs:{"data-qa":"control-box"}},[i("div",{staticClass:"control-box-controls",style:{display:t.grid?"grid":"flex"},attrs:{"data-qa":"content"}},[t._t("default")],2),t.label?i("div",{staticClass:"control-box-header",attrs:{"data-qa":"header"}},[t._v(t._s(t.label))]):t._e()])},b=[],x=class extends s["a"]{};n["a"]([Object(r["b"])()],x.prototype,"label",void 0),n["a"]([Object(r["b"])({default:!0})],x.prototype,"grid",void 0),x=n["a"]([Object(r["a"])({name:"ControlBox"})],x);var w=x,S=w,y=(i("8c48"),Object(v["a"])(S,C,b,!1,null,"fd2a2e58",null)),_=y.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cell-border-style",attrs:{"data-qa":"cell-border"}},[i("div",{staticClass:"borders all",attrs:{"data-qa":"full"},on:{click:function(e){return t.$emit("change","full-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders inside",attrs:{"data-qa":"cross"},on:{click:function(e){return t.$emit("change","cross-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders horizontal",attrs:{"data-qa":"hor"},on:{click:function(e){return t.$emit("change","horizontal-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders vertical",attrs:{"data-qa":"ver"},on:{click:function(e){return t.$emit("change","vertical-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders outside",attrs:{"data-qa":"out"},on:{click:function(e){return t.$emit("change","outside-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders left",attrs:{"data-qa":"left"},on:{click:function(e){return t.$emit("change","left-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders top",attrs:{"data-qa":"top"},on:{click:function(e){return t.$emit("change","top-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders right",attrs:{"data-qa":"right"},on:{click:function(e){return t.$emit("change","right-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders bottom",attrs:{"data-qa":"bottom"},on:{click:function(e){return t.$emit("change","bottom-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})]),i("div",{staticClass:"borders",attrs:{"data-qa":"no"},on:{click:function(e){return t.$emit("change","no-border")}}},[i("div",{staticClass:"top"}),i("div",{staticClass:"right"}),i("div",{staticClass:"left"}),i("div",{staticClass:"bottom"})])])},k=[],E=class extends s["a"]{};E=n["a"]([Object(r["a"])({name:"cell-border-style"})],E);var I=E,M=I,O=(i("ca56"),Object(v["a"])(M,A,k,!1,null,"10426fd3",null)),R=O.exports,z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedSize,expression:"selectedSize"}],staticClass:"font-size",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedSize=e.target.multiple?i:i[0]}}},t._l(t.sizes,(function(e){return i("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)},B=[],D=class extends s["a"]{constructor(){super(...arguments),this.sizes=[6,7,8,9,10,11,12,14,15,16,18,20,22,24,26,28,32,36,48,72]}get selectedSize(){return this.value}set selectedSize(t){this.$emit("input",t),this.$emit("change",t)}};n["a"]([Object(r["b"])({default:12})],D.prototype,"value",void 0),D=n["a"]([Object(r["a"])({name:"font-size-selector"})],D);var T=D,L=T,P=Object(v["a"])(L,z,B,!1,null,null,null),N=P.exports,j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"action-group",attrs:{"data-qa":"action-group"}},t._l(t.actions,(function(e){return i("action-button",{key:e.name,staticClass:"action-group-item",class:{on:e.selected},attrs:{disabled:e.disabled,"data-qa":"action-item","data-qa-name":e.name},on:{click:function(i){return t.$emit("action",e.name)}}},[t._t(e.name,[t._v(" "+t._s(e.label)+" ")])],2)})),1)},W=[],V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"action",attrs:{disabled:t.disabled,"data-qa":"action"},on:{click:function(e){return t.$emit("click")}}},[t._t("default",[t._t("prefix"),t._v(" "+t._s(t.label)+" "),t._t("postfix")])],2)},$=[],H=class extends s["a"]{};n["a"]([Object(r["b"])()],H.prototype,"label",void 0),n["a"]([Object(r["b"])({default:!1})],H.prototype,"disabled",void 0),H=n["a"]([Object(r["a"])({name:"ActionButton"})],H);var F=H,q=F,X=(i("912e"),Object(v["a"])(q,V,$,!1,null,"13139c76",null)),Y=X.exports,U=class extends s["a"]{get actions(){return this.value}};n["a"]([Object(r["b"])({required:!0})],U.prototype,"value",void 0),U=n["a"]([Object(r["a"])({name:"ActionGroup",components:{ActionButton:Y}})],U);var G=U,J=G,K=(i("76a9"),Object(v["a"])(J,j,W,!1,null,"5f4b089e",null)),Z=K.exports,Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"color-picker",attrs:{"data-qa":"color-picker"}},[i("label",{attrs:{"data-qa":"label"}},[t._t("default",[t.$slots["prefix"]?i("span",{staticClass:"prefix"},[t._t("prefix")],2):t._e(),t._v(" "+t._s(t.label)+" "),t._t("postfix")])],2),i("input",{directives:[{name:"model",rawName:"v-model",value:t.color,expression:"color"}],attrs:{type:"color","data-qa":"input-el"},domProps:{value:t.color},on:{input:function(e){e.target.composing||(t.color=e.target.value)}}})])},tt=[],et=class extends s["a"]{get color(){return this.value?this.value:"#ffffff"}set color(t){this.$emit("input",t)}};n["a"]([Object(r["b"])({default:"#ffffff"})],et.prototype,"value",void 0),n["a"]([Object(r["b"])()],et.prototype,"label",void 0),et=n["a"]([Object(r["a"])({name:"ColorPicker"})],et);var it,st,ot=et,lt=ot,nt=(i("6299"),Object(v["a"])(lt,Q,tt,!1,null,"1bf526e3",null)),rt=nt.exports;i("5319");(function(t){t[t["Left"]=0]="Left",t[t["Right"]=1]="Right",t[t["Center"]=2]="Center"})(it||(it={})),function(t){t[t["SolidThin"]=0]="SolidThin",t[t["SolidThick"]=1]="SolidThick",t[t["SolidDouble"]=2]="SolidDouble",t[t["DottedThin"]=3]="DottedThin",t[t["DottedThick"]=4]="DottedThick",t[t["DashedThin"]=5]="DashedThin",t[t["DashedThick"]=6]="DashedThick",t[t["DotDashedThin"]=7]="DotDashedThin",t[t["DotDashedThick"]=8]="DotDashedThick"}(st||(st={}));class at{constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.color=t,this.style=st.SolidThin}static from(t){var e=new at;return e.style=t.style,e.color=t.color,e}}class ht{constructor(){this.textAlign=it.Left,this.fontName="Lato",this.fontSize=12}get bold(){return!(!this.textStyle||-1==this.textStyle.indexOf("bold"))}set bold(t){this.ensureTextStyle(),this.bold!=t&&(this.textStyle=t?"".concat(this.textStyle," bold"):this.textStyle.replace("bold",""))}get italic(){return!(!this.textStyle||-1==this.textStyle.indexOf("italic"))}set italic(t){this.ensureTextStyle(),this.italic!=t&&(this.textStyle=t?"".concat(this.textStyle," italic"):this.textStyle.replace("italic",""))}get underline(){return!(!this.textStyle||-1==this.textStyle.indexOf("underline"))}set underline(t){this.ensureTextStyle(),this.italic!=t&&this.textStyle&&(this.textStyle=t?"".concat(this.textStyle," underline"):this.textStyle.replace("underline",""))}static from(t){var e=new ht;return e.textAlign=t.textAlign,e.textStyle=t.textStyle,e.fontName=t.fontName,e.fontSize=t.fontSize,e.text=t.text,e.background=t.background,e.horizontalBorder=t.horizontalBorder&&at.from(t.horizontalBorder),e.verticalBorder=t.verticalBorder&&at.from(t.verticalBorder),e}alignTextTo(t){if("right"==t.toLowerCase())this.textAlign=it.Right;else if("center"==t.toLowerCase())this.textAlign=it.Center;else{if("left"!=t.toLowerCase())throw new Error("invalid text-align '".concat(t,"'"));this.textAlign=it.Left}}setHorizontal(t){this.horizontalBorder=new at,this.horizontalBorder.style=st.SolidThin,this.horizontalBorder.color=t}setVertical(t){this.verticalBorder=new at,this.verticalBorder.style=st.SolidThin,this.verticalBorder.color=t}ensureTextStyle(){this.textStyle||(this.textStyle="")}}var ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedFamily,expression:"selectedFamily"}],staticClass:"font-family",attrs:{"data-qa":"font-name-selector"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedFamily=e.target.multiple?i:i[0]}}},t._l(t.families,(function(e){return i("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)},dt=[],ut=class extends s["a"]{constructor(){super(...arguments),this.families=["Lato","Sans","Serif","Courier","Courier New"]}get selectedFamily(){return this.value}set selectedFamily(t){this.$emit("input",t),this.$emit("change",t)}};n["a"]([Object(r["b"])({default:"Lato"})],ut.prototype,"value",void 0),ut=n["a"]([Object(r["a"])({name:"font-family-selector"})],ut);var ft=ut,mt=ft,vt=Object(v["a"])(mt,ct,dt,!1,null,null,null),gt=vt.exports,pt=class extends s["a"]{constructor(){super(...arguments),this.active="menu-home",this.borderColor="black",this.menu=[{name:"menu-home",label:"Home"},{name:"menu-formulas",label:"Formulas"},{name:"menu-data",label:"Data"},{name:"menu-view",label:"View"},{name:"menu-info",label:"About"}],this.fileMode="file"}get isLocalMode(){return"local"===this.fileMode}get activeStyle(){return this.appearance||new ht}get textAlignment(){return[{name:"left",selected:this.activeStyle.textAlign===it.Left},{name:"center",selected:this.activeStyle.textAlign===it.Center},{name:"right",selected:this.activeStyle.textAlign===it.Right}]}get fontStyle(){return[{name:"bold",selected:this.activeStyle.bold},{name:"italic",selected:this.activeStyle.italic},{name:"underline",selected:this.activeStyle.underline}]}get foreColor(){return this.activeStyle.text}set foreColor(t){this.onAction("fg-color",t)}get fillColor(){return this.activeStyle.background}set fillColor(t){this.onAction("bg-color",t)}get fontSize(){return this.activeStyle.fontSize}set fontSize(t){this.onAction("font-size",t)}get fontFamily(){return this.activeStyle.fontName}set fontFamily(t){this.onAction("font-name",t)}changeMode(t){this.fileMode=t,this.$emit("mode-changed",t)}onBorderChanged(t){this.onAction(t,this.borderColor)}onAlign(t){this.onAction("align",t)}toggleMerge(){this.onAction(this.state.isMerged?"unmerge":"merge")}onAction(t,e){this.$emit("action",{actionName:t,args:e})}};n["a"]([Object(r["b"])()],pt.prototype,"appearance",void 0),n["a"]([Object(r["b"])({default:()=>({isMerged:!0})})],pt.prototype,"state",void 0),pt=n["a"]([Object(r["a"])({name:"RibbonMenu",components:{FontFamilySelector:gt,ActionButton:Y,ColorPicker:rt,ActionGroup:Z,FontSizeSelector:N,CellBorderStyle:R,ControlBox:_,Ribbon:p}})],pt);var Ct=pt,bt=Ct,xt=(i("4e2e"),Object(v["a"])(bt,a,h,!1,null,"18ab77ce",null)),wt=xt.exports,St=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"formula-bar",class:{active:t.active}},[i("input",{staticClass:"cell-name",attrs:{type:"text",placeholder:"SELECTION"},domProps:{value:t.label}}),i("span",{staticClass:"side"},[i("span",{staticClass:"actions"},[i("i",{staticClass:"fa fa-times cancel",on:{click:function(e){return t.$emit("abort")}}}),i("i",{staticClass:"fa fa-check commit",on:{click:function(e){return t.$emit("commit")}}})]),t._v(" 𝑓𝑥 ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.formula,expression:"formula"}],staticClass:"formula",attrs:{id:"formula-input",type:"text"},domProps:{value:t.formula},on:{focusin:function(e){t.active=!0},focusout:function(e){t.active=!1},input:function(e){e.target.composing||(t.formula=e.target.value)}}}),t._m(0)])},yt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"arrow"},[i("i",{staticClass:"fas fa-angle-down"})])}],_t=class extends s["a"]{constructor(){super(...arguments),this.active=!1}get formula(){return this.value}set formula(t){this.$emit("input",t)}};n["a"]([Object(r["b"])()],_t.prototype,"value",void 0),n["a"]([Object(r["b"])()],_t.prototype,"label",void 0),_t=n["a"]([Object(r["a"])({name:"FormulaBar"})],_t);var At=_t,kt=At,Et=(i("0cfa"),Object(v["a"])(kt,St,yt,!1,null,"88f8b63a",null)),It=Et.exports,Mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"canvas-container",staticClass:"open-sheet"})},Ot=[];i("1276"),i("2ca0");class Rt{constructor(t,e){this.colSpan=1,this.rowSpan=1,this.reference=null,this._value=null,this._columnId=t,this._rowId=e}get isMerged(){return null!==this.reference}get columnId(){return this._columnId}get rowId(){return this._rowId}get label(){return this.formattedValue}get value(){return this._value}set value(t){this.update(t,t)}get top(){return this.isMerged&&this.reference?this.reference.top:this.rowId}get left(){return this.isMerged&&this.reference?this.reference.left:this.columnId}get bottom(){return this.isMerged&&this.reference?this.reference.bottom:this.rowId+this.rowSpan}get right(){return this.isMerged&&this.reference?this.reference.right:this.columnId+this.colSpan}static from(t){var e=new Rt(t.columnId,t.rowId);return e.colSpan=t.colSpan,e.rowSpan=t.rowSpan,e.formattedValue=t.formattedValue,e.evaluatedValue=t.evaluatedValue,e._columnId=t._columnId,e._rowId=t._rowId,e._value=t._value,e.reference=t.reference&&this.from(t.reference),e}update(t,e){this._value=t,this.evaluatedValue=e,this.format()}to(){return{colSpan:this.colSpan,rowSpan:this.rowSpan,formattedValue:this.formattedValue,evaluatedValue:this.evaluatedValue,_columnId:this._columnId,_rowId:this._rowId,_value:this._value,reference:this.reference&&this.reference.to()}}format(){this.formattedValue=this.evaluatedValue}}var zt=30,Bt=110,Dt=30,Tt=30,Lt=30,Pt="#fff",Nt="#00897b",jt="#00796b",Wt="#00454d",Vt=i("b619");class $t{constructor(){this.left=0,this.top=0,this.right=0,this.bottom=0,this.rowId=0,this.columnId=0}get single(){return this.right==this.left&&this.top==this.bottom}toString(){return"".concat(this.top," ").concat(this.left," - ").concat(this.bottom," ").concat(this.right)}}class Ht{constructor(t){this.title=t,this.defaultAppearance=new ht,this.defaultRowHeight=30,this.defaultColumnWidth=100,this.data=[],this.appearance=[],this.columnAppearance=[],this.rowAppearance=[],this.rowHeight=[],this.columnWidth=[],this.scrollX=0,this.scrollY=0,this.change_listeners=[],this.defaultAppearance.background=null,this.defaultAppearance.fontName="Lato",this.defaultAppearance.fontSize=12,this.defaultAppearance.horizontalBorder=null,this.defaultAppearance.verticalBorder=null,this.defaultAppearance.text="#333333",this.selection=new $t,this.selection.top=0,this.selection.left=0,this.selection.right=0,this.selection.bottom=0,this.selection.rowId=0,this.selection.columnId=0}get SelectionLabel(){return this.getCellName(this.selection.columnId,this.selection.rowId)}get SelectedValue(){return this.selectedCell&&this.selectedCell.value}get SelectedAppearance(){return this.getAppearance(this.selection.columnId,this.selection.rowId)}get selectedCell(){return this.getCell(this.selection.columnId,this.selection.rowId)}get invalidSelection(){return this.selectedCell&&this.selectedCell.isMerged}get scrollColumn(){return this.scrollX}get scrollRow(){return this.scrollY}static get_columnName(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="",s=t+1;while(s>0){var o=(s-1)%26,l=e[o];i=l+i,s=(s-(o+1))/26}return i}static load(t){var e=new Ht(t.title);return e.fill(t.data),e.style(t.appearance),e.columnAppearance=t.columnAppearance,e.rowAppearance=t.rowAppearance,e.columnWidth=t.columnWidth,e.rowHeight=t.rowHeight,e.scrollX=t.scrollX,e.scrollY=t.scrollY,e.selection=t.selection,e}selectNextColumnCell(){if(this.selection.columnId++,this.selection.single)return this.selection.right=this.selection.columnId,this.selection.left=this.selection.columnId,void this.onChange();this.selection.columnId>this.selection.right&&(this.selection.columnId=this.selection.left,this.selection.rowId==this.selection.bottom?this.selection.rowId=this.selection.top:this.selectNextRowCell()),this.invalidSelection&&this.selectNextColumnCell(),this.onChange()}selectPreviousColumnCell(){if(0!=this.selection.columnId){if(this.selection.columnId--,this.selection.single)return this.selection.right=this.selection.columnId,this.selection.left=this.selection.columnId,void this.onChange();this.selection.columnId<this.selection.left&&(this.selection.columnId=this.selection.right,this.selection.rowId==this.selection.top?this.selection.rowId=this.selection.bottom:this.selectPreviousRowCell()),this.invalidSelection&&this.selectPreviousColumnCell(),this.onChange()}}selectNextRowCell(){if(this.selection.rowId++,this.selection.single)return this.selection.top=this.selection.rowId,this.selection.bottom=this.selection.rowId,void this.onChange();this.selection.rowId>this.selection.bottom&&(this.selection.rowId=this.selection.top,this.selection.columnId==this.selection.right?this.selection.columnId=this.selection.left:this.selectNextColumnCell()),this.invalidSelection&&this.selectNextRowCell(),this.onChange()}selectPreviousRowCell(){if(0!=this.selection.rowId){if(this.selection.rowId--,this.selection.single)return this.selection.top=this.selection.rowId,this.selection.bottom=this.selection.rowId,void this.onChange();this.selection.rowId<this.selection.top&&(this.selection.rowId=this.selection.bottom,this.selection.columnId==this.selection.left?this.selection.columnId=this.selection.right:this.selectPreviousColumnCell()),this.invalidSelection&&this.selectPreviousRowCell(),this.onChange()}}getEvaluatedValue(t){if(-1!=(""+t).indexOf(":")){for(var e=t.split(":"),i=this.getCellPos(e[0]),s=this.getCellPos(e[1]),o=[],l=i.columnId;l<=s.columnId;l++)for(var n=i.rowId;n<=s.rowId;n++)o.push(this.getCellEvaluatedValue(l,n));return o}var{rowId:r,columnId:a}=this.getCellPos(t);return this.getCellEvaluatedValue(a,r)}removeCell(t,e){this.data[t]&&this.data[t][e]&&(this.data[t][e]=void 0)}setCellValue(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(null!=i){var o=this.forceGetCell(t,e);if(i.startsWith("=")){var l=Vt["a"].Eval(this,i);o.update(i,l)}else o.value=i;s||(this.updateDependees(t,e),this.onChange())}else this.removeCell(t,e)}getColumnLeft(t){for(var e=0,i=this.scrollColumn;i<t;i++)e+=this.getColumnWidth(i);return e}getColumnRight(t){return this.getColumnLeft(t)+this.getColumnWidth(t)}getRowTop(t){for(var e=0,i=this.scrollRow;i<t;i++)e+=this.getRowHeight(i);return e}getRowBottom(t){return this.getRowTop(t)+this.getRowHeight(t)}findColumnIdByX(t){if(t<0)return 0;for(var e=0,i=this.scrollColumn;;i++){if(i>this.scrollColumn+100)return 0;var s=this.getColumnWidth(i);if(t>e&&t<e+s)return i;e+=s}}findRowIdByY(t){var e=this.getRowHeight(this.scrollRow),i=this.scrollRow;while(e<t)i++,e+=this.getRowHeight(i);return i}findCellByXY(t,e){var i=this.findColumnIdByX(t),s=this.findRowIdByY(e);return this.getCell(i,s)}selectByXY(t,e,i,s){var o=Math.min(e,s),l=Math.min(t,i),n=Math.max(t,i),r=Math.max(e,s),a=this.findRowIdByY(o),h=this.findRowIdByY(r),c=this.findColumnIdByX(l),d=this.findColumnIdByX(n),u=this.findRowIdByY(e),f=this.findColumnIdByX(t),m=this.getCell(f,u);m&&m.reference&&m.isMerged&&(u=m.reference.rowId,f=m.reference.columnId);for(var v=a,g=h+1,p=c,C=d+1,b=c;b<=d;b++)for(var x=a;x<=h;x++){var w=this.getCell(b,x);w&&(v=Math.min(v,w.top),p=Math.min(p,w.left),g=Math.max(g,w.bottom),C=Math.max(C,w.right))}this.selection.top=v,this.selection.left=p,this.selection.right=C-1,this.selection.bottom=g-1,this.selection.rowId=u,this.selection.columnId=f,this.onChange()}scrollDown(){this.scroll(this.scrollColumn,this.scrollRow+1)}scrollUp(){this.scroll(this.scrollColumn,this.scrollRow-1)}scrollLeft(){this.scroll(this.scrollColumn+1,this.scrollRow)}scrollRight(){this.scroll(this.scrollColumn-1,this.scrollRow)}getCellHeight(t){for(var e=0,i=t.rowId;i<t.rowId+t.rowSpan;i++)e+=this.getRowHeight(i);return e}getCellWidth(t){for(var e=0,i=t.columnId;i<t.columnId+t.colSpan;i++)e+=this.getColumnWidth(i);return e}scroll(t,e){if(!(t<0)&&!(e<0)){for(var i in this.data)for(var s in this.data[i]){var o=this.data[i][s];o.columnId<parseInt(i)&&(t=o.columnId+o.colSpan),o.rowId<parseInt(s)&&(e=o.rowId+o.rowSpan)}this.scrollX=t,this.scrollY=e,this.onChange()}}merge(t,e,i,s){var o=this.forceGetCell(t,e);o.colSpan=i,o.rowSpan=s,this.setCell(t,e,o);for(var l=t;l<t+i;l++)for(var n=e;n<e+s;n++)if(n!=e||l!=t){var r=this.forceGetCell(l,n);r.reference=o,this.setCell(l,n,r)}this.onChange()}unmerge(t,e){var i=this.getCell(t,e);if(i&&(1!=i.rowSpan||1!=i.colSpan)){for(var s=0;s<i.colSpan;s++)for(var o=0;o<i.rowSpan;o++){var l=this.getCell(s+t,o+e);l&&(l.reference=null,this.setCell(s+t,o+e,l,!0))}i.rowSpan=1,i.colSpan=1,this.setCell(t,e,i,!0),this.onChange()}}forceGetCell(t,e){var i=this.getCell(t,e);return i||(i=new Rt(t,e),this.setCell(t,e,i)),i}getCell(t,e){return this.data[t]&&this.data[t][e]?this.data[t][e]:null}setCell(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.data[t]||(this.data[t]=[]),this.data[t][e]=i,s||this.onChange()}getColumnAppearance(t){return this.columnAppearance[t]}getRowAppearance(t){return this.rowAppearance[t]}getCellAppearance(t,e){return this.appearance[t]&&this.appearance[t][e]?this.appearance[t][e]:null}setCellAppearance(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.appearance[t]||(this.appearance[t]=[]),this.appearance[t][e]=i,s||this.onChange()}setColumAppearance(t,e){this.columnAppearance[t]=e,this.onChange()}setRowAppearance(t,e){this.rowAppearance[t]=e,this.onChange()}getRowHeight(t){return this.rowHeight[t]||this.defaultRowHeight}setRowHeight(t,e){this.rowHeight[t]=e,this.onChange()}getColumnWidth(t){return this.columnWidth[t]||this.defaultColumnWidth}setColumnWidth(t,e){this.columnWidth[t]=e,this.onChange()}getAppearance(t,e){var i=new ht,s=this.getCellAppearance(t,e),o=this.getColumnAppearance(t),l=this.getRowAppearance(e),n=this.defaultAppearance;return i.background=s&&s.background||o&&o.background||l&&l.background||n.background,i.fontName=s&&s.fontName||o&&o.fontName||l&&l.fontName||n.fontName,i.fontSize=s&&s.fontSize||o&&o.fontSize||l&&l.fontSize||n.fontSize,i.horizontalBorder=s&&s.horizontalBorder||o&&o.horizontalBorder||l&&l.horizontalBorder||n.horizontalBorder,i.verticalBorder=s&&s.verticalBorder||o&&o.verticalBorder||l&&l.verticalBorder||n.verticalBorder,i.text=s&&s.text||o&&o.text||l&&l.text||n.text,i.textAlign=s&&s.textAlign||o&&o.textAlign||l&&l.textAlign||n.textAlign,i.textStyle=s&&s.textStyle||o&&o.textStyle||l&&l.textStyle||n.textStyle,i}addOnChange(t){this.change_listeners.push(t)}removeOnChange(t){var e=this.change_listeners.indexOf(t);e>=0&&this.change_listeners.splice(e,1)}getWidth(t){return Bt}save(){return{title:this.title,data:this.data,appearance:this.appearance,columnAppearance:this.columnAppearance,rowAppearance:this.rowAppearance,rowHeight:this.rowHeight,columnWidth:this.columnWidth,scrollX:this.scrollX,scrollY:this.scrollY,selection:this.selection}}getCellName(t,e){return"".concat(Ht.get_columnName(t)).concat(e+1)}getCellPos(t){var e=/([a-zA-z]+)([0-9]+)/g;if(!/([a-zA-z]+)([0-9]+)/g.test(t))throw new Error("invalid cell name "+t);var i=e.exec(t),s=this.getColumnIndex(i[1]),o=parseInt(i[2])-1;return{rowId:o,columnId:s}}getColumnIndex(t){for(var e=0,i=1,s=65,o=t.length-1;o>=0;o--){var l=t.charCodeAt(o)-s;e+=l*i,i*=26,s=64}return e}getCellEvaluatedValue(t,e){var i=this.getCell(t,e);return null==i?null:Vt["a"].Eval(this,i.value)}updateDependees(t,e){for(var i of this.data)if(i)for(var s of i)s&&s.value&&s.value.length&&"="==s.value[0]&&this.setCellValue(s.columnId,s.rowId,s.value,!0)}onChange(){this.change_listeners.forEach(t=>t())}fill(t){for(var e of(this.data=[],t))if(e)for(var i of e)if(i){var s=Rt.from(i);this.setCell(s.columnId,s.rowId,s,!0)}}style(t){if(this.appearance=[],t)for(var e of t)if(e)for(var i of e)if(i){var s=ht.from(i),o=t.indexOf(e),l=e.indexOf(i);this.setCellAppearance(o,l,s,!0)}}}function Ft(t){return JSON.parse(JSON.stringify(t))}class qt{constructor(t){this.doc=t,this.history=[],this.commands={},this.commands.bold=()=>this.appearance(t=>t.bold=!t.bold),this.commands.italic=()=>this.appearance(t=>t.italic=!t.italic),this.commands.underline=()=>this.appearance(t=>t.underline=!t.underline),this.commands["font-size"]=t=>this.appearance(e=>e.fontSize=t),this.commands["font-name"]=t=>this.appearance(e=>e.fontName=t),this.commands["bg-color"]=t=>this.appearance(e=>e.background=t),this.commands["fg-color"]=t=>this.appearance(e=>e.text=t),this.commands["top-border"]=t=>this.topBorder(t),this.commands["no-border"]=()=>this.noBorder(),this.commands["left-border"]=t=>this.leftBorder(t),this.commands["right-border"]=t=>this.rightBorder(t),this.commands["bottom-border"]=t=>this.bottomBorder(t),this.commands["outside-border"]=t=>this.outsideBorder(t),this.commands["horizontal-border"]=t=>this.horizontalBorder(t),this.commands["vertical-border"]=t=>this.verticalBorder(t),this.commands["cross-border"]=t=>this.crossBorder(t),this.commands["full-border"]=t=>{this.topBorder(t,!1),this.leftBorder(t,!1),this.bottomBorder(t,!1),this.rightBorder(t,!1),this.appearance(e=>{e.setVertical(t),e.setHorizontal(t)})},this.commands.merge=()=>this.merge(),this.commands.unmerge=()=>this.unmerge(),this.commands.align=t=>this.appearance(e=>e.alignTextTo(t)),this.commands["change-value"]=(t,e,i)=>this.changeValue(t,e,i),this.commands["alter-column"]=(t,e)=>this.alterColumn(t,e),this.commands["alter-row"]=(t,e)=>this.alterRow(t,e)}get ActiveSheet(){return this.doc.ActiveSheet}get Selection(){return this.ActiveSheet.selection}get SelectedAppearance(){for(var t=this.Selection,e=this.doc.ActiveSheet,i=[],s=t.top;s<=t.bottom;s++)for(var o=t.left;o<=t.right;o++){var l=e.getCellAppearance(t.columnId,t.rowId);l&&i.push(Ft(l))}return i}get SelectionData(){for(var t=this.Selection,e=this.doc.ActiveSheet,i=[],s=t.left;s<=t.right;s++)for(var o=t.top;o<=t.bottom;o++){var l=e.getCell(s,o);i.push(Ft(l))}return i}do(t){this.has(t)||console.warn("command ".concat(t," does not exsits!"));for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];this.commands[t](...i)}undo(){throw new Error("undo has not been implemented")}redo(){throw new Error("redo has not been implemented")}has(t){return!!this.commands[t]}outsideBorder(t){this.logAppearanceOnlyCommand(),this.topBorder(t,!1),this.rightBorder(t,!1),this.bottomBorder(t,!1),this.leftBorder(t,!1)}horizontalBorder(t){this.crossBorder(t,!0,!1)}verticalBorder(t){this.crossBorder(t,!1,!0)}crossBorder(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.logAppearanceOnlyCommand();for(var s=this.Selection,o=(this.doc.ActiveSheet,s.left);o<=s.right;o++)for(var l=s.top;l<=s.bottom;l++){var n=this.ActiveSheet.getCellAppearance(o,l)||new ht;e&&l<s.bottom&&n.setHorizontal(t),i&&o<s.right&&n.setVertical(t),this.ActiveSheet.setCellAppearance(o,l,n,!1)}}noBorder(){this.logAppearanceOnlyCommand(),this.topBorder(null,!1),this.leftBorder(null,!1),this.appearance(t=>{t.setVertical(null),t.setHorizontal(null)})}topBorder(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.logAppearanceOnlyCommand();for(var i=this.Selection,s=(this.doc.ActiveSheet,i.top-1),o=i.left;o<=i.right;o++){var l=this.ActiveSheet.getCellAppearance(o,s)||new ht;l.setHorizontal(t),this.ActiveSheet.setCellAppearance(o,s,l,!1)}}leftBorder(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.logAppearanceOnlyCommand();for(var i=this.Selection,s=(this.doc.ActiveSheet,i.left-1),o=i.top;o<=i.bottom;o++){var l=this.ActiveSheet.getCellAppearance(s,o)||new ht;l.setVertical(t),this.ActiveSheet.setCellAppearance(s,o,l,!1)}}rightBorder(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.logAppearanceOnlyCommand();for(var i=this.Selection,s=(this.doc.ActiveSheet,i.right),o=i.top;o<=i.bottom;o++){var l=this.ActiveSheet.getCellAppearance(s,o)||new ht;l.setVertical(t),this.ActiveSheet.setCellAppearance(s,o,l,!1)}}bottomBorder(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.logAppearanceOnlyCommand();for(var i=this.Selection,s=this.doc.ActiveSheet,o=i.left;o<=i.right;o++){var l=s.getCellAppearance(o,i.bottom)||new ht;l.setHorizontal(t),s.setCellAppearance(o,i.bottom,l,!1)}}logAppearanceOnlyCommand(){var t=this.Selection,e={selection:t,appearance:this.SelectedAppearance};this.history.push(e)}logDataOnlyCommand(){var t=this.Selection,e={selection:t,data:this.SelectionData};this.history.push(e)}alterColumn(t,e){var i=this.doc.ActiveSheet.getColumnWidth(t);this.history.push({selection:t,data:i,meta:"COLUMN"}),this.doc.ActiveSheet.setColumnWidth(t,i+e)}alterRow(t,e){var i=this.doc.ActiveSheet.getRowHeight(t);this.history.push({selection:t,data:i,meta:"ROW"}),this.doc.ActiveSheet.setRowHeight(t,i+e)}changeValue(t,e,i){this.logDataOnlyCommand(),null==t&&(t=this.Selection.columnId),null==e&&(e=this.Selection.rowId),this.ActiveSheet.setCellValue(t,e,i)}merge(){this.logDataOnlyCommand();var t=this.Selection,e=Math.min(t.right,t.left),i=Math.min(t.top,t.bottom),s=Math.abs(t.right-t.left)+1,o=Math.abs(t.top-t.bottom)+1;this.ActiveSheet.merge(e,i,s,o)}unmerge(){this.logDataOnlyCommand();var t=this.Selection;this.ActiveSheet.unmerge(t.columnId,t.rowId)}appearance(t){this.logAppearanceOnlyCommand();for(var e=this.Selection,i=e.top;i<=e.bottom;i++)for(var s=e.left;s<=e.right;s++){var o=this.ActiveSheet.getCellAppearance(s,i)||new ht;t(o),this.ActiveSheet.setCellAppearance(s,i,o)}}}class Xt{constructor(){this.sheets=[],this.activeSheetIndex=0,this.change_listeners=[],this.init(),this.commander=new qt(this)}get ActiveSheet(){return this.sheets[this.activeSheetIndex]}get ActiveSheetIndex(){return this.activeSheetIndex}set ActiveSheetIndex(t){if(t<0||t>=this.sheets.length)throw new Error("invalid sheet index");this.activeSheetIndex=t,this.onChange()}get Sheets(){return this.sheets}addSheet(t){var e=new Ht(t);e.addOnChange(()=>this.onChange()),this.sheets.push(e),this.onChange()}addOnChange(t){this.change_listeners.push(t)}removeOnChange(t){var e=this.change_listeners.indexOf(t);e>=0&&this.change_listeners.splice(e,1)}onChange(){this.change_listeners.forEach(t=>t())}execCommand(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];this.commander.do(t,...i)}save(){return{sheets:this.sheets.map(t=>t.save()),activeSheetIndex:this.activeSheetIndex}}load(t){this.sheets=t.sheets.map(t=>Ht.load(t)),this.activeSheetIndex=t.activeSheetIndex,this.onChange()}init(){this.addSheet("Sheet1"),this.addSheet("Sheet2"),this.addSheet("Sheet3")}}var Yt;i("25f0"),i("498a");(function(t){t[t["LeftToRight"]=1]="LeftToRight",t[t["RightToLeft"]=2]="RightToLeft"})(Yt||(Yt={}));class Ut{constructor(t,e,i,s){this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=i,this.height=s}get_left(){return this.x}set_left(t){this.x=t}get_top(){return this.y}get_right(){return this.x+this.width}get_bottom(){return this.y+this.height}set_top(t){this.y=t}get_width(){return this.width}set_width(t){this.width=t}get_height(){return this.height}set_height(t){this.height=t}set_value(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}get_combinedMask(t,e,i,s){var o=Math.min(t+i,this.get_right()),l=Math.min(e+s,this.get_bottom());return i=Math.min(o-t,this.get_width()),s=Math.min(l-e,this.get_height()),t=Math.max(t,this.get_left()),e=Math.max(e,this.get_top()),new Ut(t,e,i,s)}}class Gt{constructor(t,e,i){this.direction=Yt.LeftToRight,this.textAlign=it.Left,this.fillStyle="#fff",this.strokeStyle="#000",this.strokeSize=1,this.contentFillStyle="#000",this.fontStyle="",this.fontSize=12,this.fontName="Tahoma",this.maskStack=[],this.context2d=t,this.width=e,this.height=i}get_directed_x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.direction===Yt.LeftToRight?t:this.width-t-e}get_textWidth(t){return this.context2d.measureText(t).width}save(){if(this.context2d.save(),this.context2d.translate(-.5,-.5),this.currentMask){var t=this.currentMask;this.context2d.rect(t.get_left(),t.get_top(),t.get_width(),t.get_height()),this.context2d.clip()}}restore(){this.context2d.restore()}setMask(t,e,i,s){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t=this.get_directed_x(t,i),this.currentMask&&this.maskStack.push(this.currentMask),o&&this.currentMask?this.currentMask=this.currentMask.get_combinedMask(t,e,i,s):this.currentMask=new Ut(t,e,i,s)}unmask(){this.maskStack.length>0?this.currentMask=this.maskStack.pop():this.currentMask=null}clearRect(t,e,i,s){t=this.get_directed_x(t,i),this.save(),this.context2d.clearRect(t,e,i,s),this.restore()}fillRect(t,e,i,s){t=this.get_directed_x(t,i),this.save(),this.applyFill(),this.context2d.beginPath(),this.context2d.fillRect(t,e,i,s),this.context2d.fill(),this.restore()}strokeRect(t,e,i,s){t=this.get_directed_x(t,i),this.save(),this.applyStroke(),this.context2d.beginPath(),this.context2d.strokeRect(t,e,i,s),this.context2d.stroke(),this.restore()}line(t,e,i,s){t=this.get_directed_x(t),i=this.get_directed_x(i),this.save(),this.applyStroke(),this.context2d.beginPath(),this.context2d.moveTo(t,e),this.context2d.lineTo(i,s),this.context2d.stroke(),this.restore()}path(t,e,i){this.save(),this.applyStroke(),this.applyFill(),this.context2d.beginPath();var s=arguments.length<=3?void 0:arguments[3],o=this.get_directed_x(s.x);this.context2d.moveTo(o,s.y);for(var l=1;l<(arguments.length<=3?0:arguments.length-3);l++){s=l+3<3||arguments.length<=l+3?void 0:arguments[l+3];var n=this.get_directed_x(s.x);this.context2d.lineTo(n,s.y)}t&&this.context2d.closePath(),i&&this.context2d.fill(),e&&this.context2d.stroke(),this.restore()}openPath(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.internalPath(!1,!0,!1,e)}closePath(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.internalPath(!0,!0,!1,e)}fillOpenPath(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.internalPath(!1,!0,!0,e)}fillClosePath(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.internalPath(!0,!1,!0,e)}rect(t,e,i,s){t=this.get_directed_x(t,i),this.fillRect(t,e,i,s),this.strokeRect(t,e,i,s)}fillText(t,e,i,s){e=this.get_directed_x(e,s),this.save(),this.applyContent();var o=0,l=this.get_textWidth(t);this.textAlign===it.Center?o=(s-l)/2:this.textAlign===it.Right&&(o=s-l-10),this.fontStyle&&-1!==this.fontStyle.indexOf("underline")&&this.rect(e,i+this.fontSize+2,this.context2d.measureText(t).width,0),this.context2d.fillText(t,e+o,i+this.fontSize),this.restore()}createGradient(t,e,i,s){for(var o=this.context2d.createLinearGradient(t,e,t+i,e+s),l=arguments.length,n=new Array(l>4?l-4:0),r=4;r<l;r++)n[r-4]=arguments[r];for(var a of n)o.addColorStop(a[0],a[1]);return o}applyFill(){this.context2d.fillStyle=this.fillStyle}applyStroke(){this.context2d.strokeStyle=this.strokeStyle,this.context2d.lineWidth=this.strokeSize}applyContent(){this.fontStyle.replace("underline","");this.context2d.fillStyle=this.contentFillStyle,this.context2d.font="".concat(this.fontStyle," ").concat(this.fontSize,"px ").concat(this.fontName).trim(),this.context2d.textAlign="left"}internalPath(t,e,i,s){var o=[t,e,i];for(var l of s)o.push(l);this.path.apply(this,o)}}class Jt{constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=e}}class Kt{constructor(t,e){this.container=t,this.document=e,this.rendering=!1,this.renderFrameRate=10,this.initialize(),e.addOnChange(()=>this.render())}get Element(){return this.container}initialize(){this.createElements(),this.resize(),this.render()}createElements(){this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas)}resize(){var t=window.devicePixelRatio;this.width=this.container.clientWidth,this.height=this.container.clientHeight,t>1?(this.canvas.width=this.width*t,this.canvas.height=this.height*t,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px"):(this.canvas.width=this.width,this.canvas.height=this.height),this.render()}get_context2D(){var t=window.devicePixelRatio;this.canvas.width=this.canvas.width;var e=this.canvas.getContext("2d");return e.scale(t,t),e}render(){this.rendering||(this.rendering=!0,setTimeout(()=>{this.doRender(),this.rendering=!1},1e3/this.renderFrameRate))}doRender(){console.log("%cRender","color:".concat(Nt));var t=this.get_context2D();this.context=new Gt(t,this.width,this.height),this.renderSheetTitles(),this.renderSheet()}renderTopCorner(){this.context.fillStyle="#ececec",this.context.fontSize=12;var t=Tt-2;this.context.fillClosePath(new Jt(2,t),new Jt(t,t),new Jt(t,1))}renderSheetTitles(){this.renderTopCorner(),this.context.strokeSize=1;var t=0,e=this.height-zt-.5,i=zt+5,s=this.height-zt-.5;this.context.rect(t,e,this.width,i),this.context.fillStyle=this.context.createGradient(0,s,0,zt/3,[0,"#f0f0f0"],[1,"#fff"]),this.context.fillRect(t,e,this.width,i),this.context.textAlign=it.Center;var o=Tt,l=this.document.ActiveSheet,n=5;for(var r of this.document.Sheets){var a=r.getWidth(t=>this.context.get_textWidth(t));this.context.strokeStyle="#aaa",this.context.fillStyle="#fafafa",this.context.fontStyle="italic",r===l&&(this.context.fillStyle="#fff",this.context.fontStyle="bold"),this.context.rect(o,s,a,zt-n),this.context.fillText(r.title,o,s+n,a),r===l&&(this.context.fillStyle=Wt,this.context.fillRect(o,s+zt-n,a,2),this.context.strokeStyle=Pt),this.context.line(o,s,o+a,s),o+=a+n}this.context.fontStyle=""}renderSheet(){var t=this.width,e=this.height,i=zt,s=e-i,o=this.context;o.setMask(0,0,t,e-(i+1.5));var l=this.renderRows(),n=this.renderColumns();o.unmask(),o.setMask(Dt+.5,Tt,t,s-Tt-.5),this.renderCells(n,l),o.unmask()}renderRows(){this.context;for(var t=this.height-Tt-zt,e=Lt,i=this.document.ActiveSheet,s=i.scrollRow;e<t;s++){var o=i.getRowHeight(s);this.paintRow(e,(s+1).toString()),e+=o}return s}paintRow(t,e){var i=this.context;i.save(),i.strokeSize=1,i.strokeStyle="#ccc",i.fillStyle="#fafafa",i.rect(0,t,Tt,this.height),i.fillRect(0,t,Tt,this.height),i.fontSize=12,i.textAlign=it.Center,i.fillText(e,0,t+(Lt-12)/2,Tt),i.restore()}renderColumns(){for(var t=this.width,e=this.document.ActiveSheet,i=Tt+.5,s=e.scrollColumn;i<=t;s++){var o=e.getColumnWidth(s);this.paintColumn(i,Ht.get_columnName(s),o),i+=o}return s}paintColumn(t,e,i){var s=this.context;s.strokeSize=1,s.strokeStyle="#ccc",s.fillStyle="#fafafa",s.fontName="Tahoma",s.fontSize=12,s.rect(t,0,this.width,Dt-1),s.fillRect(t,0,this.width,Dt-1),s.fillText(e,t,7,i)}renderCells(t,e){var i=0,s=0,o=this.document.ActiveSheet,l=this.context;l.strokeStyle="#eee",l.strokeSize=1;for(var n=o.scrollRow-1;n<e;n++){var r=o.getRowHeight(n);i=0;for(var a=o.scrollColumn;a<=t;a++){var h=o.getColumnWidth(a),c=o.getCell(a,n),d=c?o.getCellHeight(c):o.getRowHeight(n),u=c?o.getCellWidth(c):o.getColumnWidth(a),f=o.getAppearance(a,n);if(l.fillStyle=f.text,this.paintCell(a,n,i,s),s>0&&(!c||!c.isMerged)){var m=f.horizontalBorder,v=f.verticalBorder;l.strokeStyle=m&&m.color||"#eeeeee",null!=f.background&&null==m||l.line(i+Tt,s+d,i+Tt+u,s+d),l.strokeStyle=v&&v.color||"#eeeeee",null!=f.background&&null==v||l.line(i+Tt+u,s,i+Tt+u,s+d)}i+=h}s+=r}}paintCell(t,e,i,s){var o=this.context,l=this.document.ActiveSheet,n=l.getCell(t,e);if(!n||!n.isMerged){var r=l.getAppearance(t,e),a=i+Dt;if(!(s<Lt)){r.fontSize&&(o.fontSize=parseInt(r.fontSize+"")),r.fontName&&(o.fontName=r.fontName),o.fontStyle=r.textStyle?r.textStyle:"";var h=n?l.getCellWidth(n):l.getColumnWidth(t),c=n?l.getCellHeight(n):l.getRowHeight(e);o.setMask(a,s,h,c),r.background&&(o.fillStyle=r.background,o.fillRect(a,s,h,c)),n&&n.label&&(o.contentFillStyle=r.text,o.strokeStyle=r.text,o.textAlign=r.textAlign,o.fillText(n.label,i+Dt+5,s+7,h)),o.unmask()}}}}class Zt{constructor(t){this.controler=t,this.editMode=!1,this.websheet=t.websheet,this.initialize(),this.select()}get Value(){return""==this.editorElement.value?null:this.editorElement.value}set Value(t){this.editorElement&&(this.editorElement.value=t?t+"":"")}get IsDirty(){var t=this.getCurrentCell();return t.value!=this.Value}get EditMode(){return this.editMode}set EditMode(t){this.editMode=t,this.editorElement.readOnly=!t,this.editorElement.focus()}initialize(){this.editorArea=document.createElement("div"),this.editorArea.style.position="absolute",this.editorArea.style.top=Dt+"px",this.editorArea.style.left=Tt+"px",this.editorArea.style.bottom=zt+"px",this.editorArea.style.right="0px",this.editorArea.style.overflow="visible",this.controler.renderer.Element.appendChild(this.editorArea),this.selectionElement=document.createElement("div"),this.selectionElement.style.position="absolute",this.selectionElement.style.border="solid 2px ".concat(Nt),this.selectionElement.style.overflow="hidden",this.selectionElement.style.background="rgba(0,0,0,.1)",this.selectionElement.style.transitionDuration=".1s",this.editorArea.appendChild(this.selectionElement),this.editorElement=document.createElement("input"),this.editorElement.type="text",this.editorElement.style.display="block",this.editorElement.style.zIndex="10000",this.editorElement.style.position="absolute",this.editorElement.style.background="#fff",this.editorElement.style.textIndent="3px",this.editorElement.style.border="none";var t=()=>{this.EditMode||(this.EditMode=!0)};this.editorElement.addEventListener("click",t),this.editorElement.addEventListener("change",t),this.editorElement.addEventListener("touchstart",t),this.selectionElement.appendChild(this.editorElement),this.anchorElement=document.createElement("span"),this.anchorElement.style.position="absolute",this.anchorElement.style.right="0",this.anchorElement.style.bottom="0",this.anchorElement.style.width="6px",this.anchorElement.style.height="6px",this.anchorElement.style.borderRadius="2px",this.anchorElement.style.border="solid 1px #fff",this.anchorElement.style.background=jt,this.anchorElement.style.zIndex="10000",this.anchorElement.style.cursor="cell",this.editorArea.appendChild(this.anchorElement),this.websheet.addOnChange(()=>{var t=this.websheet.ActiveSheet.SelectedValue;t!=this.Value&&(this.Value=t),this.updateEditorAppearance(),this.select(!0)})}disableAnimation(){this.selectionElement.style.transitionDuration="",this.anchorElement.style.transitionDuration=""}enableAnimation(){this.selectionElement.style.transitionDuration=".1s",this.anchorElement.style.transitionDuration=".1s"}deselect(){var t=this.getCurrentCell();this.IsDirty&&this.controler.websheet.execCommand("change-value",t.columnId,t.rowId,this.Value)}updateEditorAppearance(){var t=this.getCurrentAppearance();this.editorElement.style.textAlign=this.getTextAlign(t.textAlign),this.editorElement.style.fontStyle=t.italic?"italic":"",this.editorElement.style.fontWeight=t.bold?"bold":"",this.editorElement.style.background=t.background,this.editorElement.style.fontFamily=t.fontName,this.editorElement.style.fontSize="".concat(t.fontSize,"px"),this.editorElement.style.color=t.text,this.editorElement.style.textDecoration=t.underline?"underline":""}select(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?this.enableAnimation():this.disableAnimation(),this.updateEditorAppearance();var e=this.controler.websheet.ActiveSheet,i=e.selection,s=e.getColumnLeft(i.left),o=e.getRowTop(i.top),l=e.getColumnRight(i.right),n=e.getRowBottom(i.bottom),r=l-s,a=n-o;this.selectionElement.style.left=s-2+"px",this.selectionElement.style.top=o-2+"px",this.selectionElement.style.width=r-2+"px",this.selectionElement.style.height=a-2+"px";var h=this.getCurrentCell(),c=e.getRowTop(i.rowId),d=e.getColumnLeft(i.columnId);this.editorElement.style.left=d-s+"px",this.editorElement.style.top=c-o+"px",this.editorElement.style.width=e.getCellWidth(h)-3+"px",this.editorElement.style.height=e.getCellHeight(h)-3+"px",this.editorElement.focus(),this.anchorElement.style.left="".concat(l-5,"px"),this.anchorElement.style.top="".concat(n-5,"px")}getCurrentCell(){var t=this.controler.websheet.ActiveSheet,e=t.selection;return t.getCell(e.columnId,e.rowId)||new Rt(e.columnId,e.rowId)}getCurrentAppearance(){var t=this.controler.websheet.ActiveSheet,e=t.selection;return t.getAppearance(e.columnId,e.rowId)}getTextAlign(t){return t==it.Center?"center":t==it.Left?"left":t==it.Right?"right":""}}class Qt{constructor(t){this.controller=t}click(){}dblClick(){}mouseDown(t,e){}mouseMove(t,e){}mouseUp(t,e){}mouseWheel(t,e){}keyDown(t){}keyPress(t){}keyUp(t){}get locked(){return this.controller.locked}lock(){this.controller.lock(this)}unlock(){this.controller.unlock()}}class te extends Qt{mouseUp(t,e){if(!(e<this.controller.renderer.Element.clientHeight-zt)){var i=Math.floor((t-Tt)/(Bt+5)),s=(t-Tt)%(Bt+5);s<Bt&&i<this.controller.websheet.Sheets.length&&this.controller.changeActiveSheet(i)}}}class ee extends Qt{constructor(t){super(t),this.wheelDeltaX=0,this.wheelDeltaY=0,this.sheet=t.websheet.ActiveSheet}mouseWheel(t,e){this.wheelDeltaX+=t,this.wheelDeltaY+=e;var i=this.controller.websheet,s=i.ActiveSheet,o=120;this.wheelDeltaX>o?(s.scrollRight(),this.wheelDeltaX=0):this.wheelDeltaX<-o&&(s.scrollLeft(),this.wheelDeltaX=0),this.wheelDeltaY>o?(s.scrollUp(),this.wheelDeltaY=0):this.wheelDeltaY<-o&&(s.scrollDown(),this.wheelDeltaY=0),this.controller.renderer.render(),this.controller.select()}mouseDown(t,e){this.oldX=t,this.oldY=e}mouseUp(t,e){this.selectCell(t,e)}keyPress(t){if("Enter"==t.key){if(!this.controller.EditMode)return void(this.controller.EditMode=!0);this.controller.commit(),this.controller.EditMode=!1,t.shiftKey?this.sheet.selectPreviousRowCell():this.sheet.selectNextRowCell()}}keyDown(t){"Tab"==t.key&&(this.controller.deselect(),t.shiftKey?this.sheet.selectPreviousColumnCell():this.sheet.selectNextColumnCell(),t.preventDefault(),this.controller.select(!0)),this.controller.EditMode||"ArrowRight"!=t.key&&"ArrowLeft"!=t.key&&"ArrowUp"!=t.key&&"ArrowDown"!=t.key||(this.controller.deselect(),"ArrowRight"==t.key?this.sheet.selectNextColumnCell():"ArrowLeft"==t.key?this.sheet.selectPreviousColumnCell():"ArrowUp"==t.key?this.sheet.selectPreviousRowCell():"ArrowDown"==t.key&&this.sheet.selectNextRowCell(),t.preventDefault(),this.controller.select(!0))}dblClick(){this.controller.EditMode||(this.controller.EditMode=!0)}selectCell(t,e){if(!(e<Dt||t<Tt)&&!(e>this.controller.renderer.Element.clientHeight-zt)){var i=this.controller.websheet.ActiveSheet,s=this.oldX-Tt,o=this.oldY-Dt,l=t-Tt,n=e-Dt;this.controller.deselect(),i.selectByXY(s,o,l,n),this.controller.select(!0)}}}var ie=4;class se extends Qt{constructor(){super(...arguments),this.engaged=!1}mouseMove(t,e){var i=this.hitColumn(t-Tt,e),s=this.hitRow(t,e-Dt);!1!==i?this.controller.changeCursor("col-resize"):!1!==s?this.controller.changeCursor("row-resize"):this.engaged||this.controller.resetCursor()}mouseDown(t,e){this.col=this.hitColumn(t-Tt,e),this.row=this.hitRow(t,e-Dt),this.oldX=t,this.oldY=e,!1!==this.col||!1!==this.row?(this.lock(),!1!==this.col?this.controller.changeCursor("col-resize"):!1!==this.row&&this.controller.changeCursor("row-resize"),this.engaged=!0):this.engaged=!1}mouseUp(t,e){this.engaged&&(!1!==this.col&&(this.controller.alterColumn(this.col,t-this.oldX),this.controller.resetCursor()),!1!==this.row&&(this.controller.alterRow(this.row,e-this.oldY),this.controller.resetCursor()),this.unlock())}hitRow(t,e){if(t>Tt)return!1;for(var i=t=>this.controller.websheet.ActiveSheet.getRowHeight(t),s=0,o=i(s++);o<e+ie;o+=i(s++))if(e>o-ie&&e<o+ie)return s-1;return!1}hitColumn(t,e){if(e>Dt)return!1;for(var i=t=>this.controller.websheet.ActiveSheet.getColumnWidth(t),s=0,o=i(s++);o<t+ie;o+=i(s++))if(t>o-ie&&t<o+ie)return s-1;return!1}}class oe{constructor(t,e){this.websheet=t,this.renderer=e,this.handlers=[],this.lockedOn=null,this.cellEditor=new Zt(this),this.addHandlers(),this.attachEvents(),t.addOnChange(()=>this.cellEditor.updateEditorAppearance())}get EditMode(){return this.cellEditor.EditMode}set EditMode(t){this.cellEditor.EditMode=t}get locked(){return!!this.lockedOn}select(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.cellEditor.select(t)}deselect(){this.cellEditor.deselect()}alterColumn(t,e){this.websheet.execCommand("alter-column",t,e)}alterRow(t,e){this.websheet.execCommand("alter-row",t,e)}lock(t){this.lockedOn=t}unlock(){this.lockedOn=null}resetCursor(){this.renderer.Element.style.cursor=""}changeCursor(t){this.renderer.Element.style.cursor=t}attachEvents(){var t=this.renderer.Element,e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.right="0",e.style.bottom="0",e.style.zIndex="9999",t.appendChild(e);var i=this,s=function(e){var i=e.offsetX||e.layerX||e.clientX-t.offsetLeft,s=e.offsetY||e.layerY||e.clientY-t.offsetTop;return{x:i,y:s}},o=function(e){var i=e.touches.length?e.touches[0]:e.changedTouches[0],s=i.clientX-t.offsetLeft,o=i.clientY-t.offsetTop;return{x:s,y:o}};e.addEventListener("touchstart",t=>{if(1==t.touches.length){var e=o(t);i.mouseDown(e.x,e.y),t.preventDefault()}}),e.addEventListener("touchmove",t=>{var e=o(t);i.mouseMove(e.x,e.y)}),e.addEventListener("touchend",t=>{var e=o(t);i.mouseUp(e.x,e.y)}),e.addEventListener("touchcancel",t=>{var e=o(t);i.mouseUp(e.x,e.y)}),e.addEventListener("mousedown",t=>{var e=s(t);i.mouseDown(e.x,e.y)}),e.addEventListener("mousemove",t=>{var e=s(t);i.mouseMove(e.x,e.y)}),e.addEventListener("mouseup",t=>{var e=s(t);i.mouseUp(e.x,e.y)}),e.addEventListener("click",t=>i.click()),e.addEventListener("dblclick",t=>i.dblClick()),e.addEventListener("mousewheel",t=>{var e=t.wheelDeltaX,s=t.wheelDeltaY;return i.mouseWheel(e,s),t.preventDefault(),t.stopPropagation(),!1}),window.addEventListener("keydown",t=>i.keyDown(t)),window.addEventListener("keypress",t=>i.keyPress(t)),window.addEventListener("keyup",t=>i.keyUp(t)),window.addEventListener("resize",()=>this.renderer.resize())}click(){if(this.lockedOn)this.lockedOn.click();else for(var t=0;t<this.handlers.length;t++)this.handlers[t].click()}dblClick(){if(this.lockedOn)this.lockedOn.dblClick();else for(var t=0;t<this.handlers.length;t++)this.handlers[t].dblClick()}mouseDown(t,e){if(this.lockedOn)this.lockedOn.mouseDown(t,e);else for(var i=0;i<this.handlers.length;i++)this.handlers[i].mouseDown(t,e)}mouseMove(t,e){if(this.lockedOn)this.lockedOn.mouseMove(t,e);else for(var i=0;i<this.handlers.length;i++)this.handlers[i].mouseMove(t,e)}mouseUp(t,e){if(this.lockedOn)this.lockedOn.mouseUp(t,e);else for(var i=0;i<this.handlers.length;i++)this.handlers[i].mouseUp(t,e)}mouseWheel(t,e){if(this.lockedOn)this.lockedOn.mouseWheel(t,e);else for(var i=0;i<this.handlers.length;i++)this.handlers[i].mouseWheel(t,e)}keyDown(t){if(this.lockedOn)this.lockedOn.keyDown(t);else for(var e=0;e<this.handlers.length;e++)this.handlers[e].keyDown(t)}keyPress(t){if(this.lockedOn)this.lockedOn.keyPress(t);else for(var e=0;e<this.handlers.length;e++)this.handlers[e].keyPress(t)}keyUp(t){if(this.lockedOn)this.lockedOn.keyUp(t);else for(var e=0;e<this.handlers.length;e++)this.handlers[e].keyUp(t)}changeActiveSheet(t){this.cellEditor.deselect(),this.websheet.ActiveSheetIndex=t,this.cellEditor.select(!1)}commit(){this.cellEditor.deselect(),this.cellEditor.select(!1)}addHandlers(){this.handlers.push(new te(this)),this.handlers.push(new ee(this)),this.handlers.push(new se(this))}}class le{constructor(t){this.element=t,this.handlers=[],this.document=new Xt,this.render=null,this.render=new Kt(t,this.document),this.uiController=new oe(this.document,this.render),this.document.addOnChange(()=>this.raiseOnChangeEventListener()),this.render.render(),t.openDocument=this.document}get isMerged(){var t=this.selectedCell;return!!t&&(t.colSpan>1||t.rowSpan>1)}get selectedCell(){return this.document.ActiveSheet.selectedCell}get SelectedCellLabel(){return this.document.ActiveSheet.SelectionLabel}get SelectedValue(){return this.document.ActiveSheet.SelectedValue}get SelectedAppearance(){return this.document.ActiveSheet.SelectedAppearance}execCmd(t){console.log("the command _".concat(t,"_ executed.")),this.uiController.commit();for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];this.document.execCommand(t,...i)}addOnChangeEventListener(t){this.handlers.push(t)}removeOnChangeEventListener(t){var e=this.handlers.indexOf(t);-1!=e&&this.handlers.splice(e,1)}save(){return JSON.stringify(this.document.save())}load(t){var e=JSON.parse(t);this.document.load(e)}raiseOnChangeEventListener(){this.handlers.forEach(t=>t(this.document))}}var ne=class extends s["a"]{execute(t,e){this.ui.execCmd(t,e)}load(t){this.ui.load(t)}mounted(){this.ui=new le(this.$refs["canvas-container"]),this.$emit("ready",this.ui),this.ui.addOnChangeEventListener(t=>{this.$emit("change",t)})}};ne=n["a"]([Object(r["a"])({name:"OpenSheet"})],ne);var re=ne,ae=re,he=(i("60d7"),Object(v["a"])(ae,Mt,Ot,!1,null,"6835bc7c",null)),ce=he.exports,de=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v("Sheets1 | Sheet 2 | Sheet 3")])},ue=[],fe={name:"SheetSelector"},me=fe,ve=Object(v["a"])(me,de,ue,!1,null,null,null),ge=ve.exports,pe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"status-bar"})},Ce=[],be={name:"StatusBar"},xe=be,we=(i("5b4a"),Object(v["a"])(xe,pe,Ce,!1,null,"2c4dd48e",null)),Se=we.exports,ye=class extends r["c"]{constructor(){super(...arguments),this.appearance=new ht,this.fileMode="file",this.state={isMerged:!1,label:"A1",value:null,originalValue:null}}onReady(t){this.uiManager=t}onChange(t){this.appearance=t.ActiveSheet.SelectedAppearance,this.state.isMerged=this.uiManager.isMerged,this.state.label=t.ActiveSheet.SelectionLabel,this.state.value=t.ActiveSheet.SelectedValue,this.state.originalValue=t.ActiveSheet.SelectedValue,"local"===this.fileMode&&localStorage.setItem("data",JSON.stringify(t.save()))}onCommit(){this.state.value!==this.state.originalValue&&this.uiManager.execCmd("change-value",null,null,this.state.value)}onAbort(){this.state.value=this.state.originalValue}onAction(t){var{actionName:e,args:i}=t;"save-ows"!==e?"load-ows"!==e?this.uiManager.execCmd(e,i):this.onLoad():this.onSave()}onModeChanged(t){"file"===this.fileMode&&null!==localStorage.getItem("data")&&this.$refs.sheet.load(localStorage.getItem("data")),this.fileMode=t}onLoad(){var t=window,e=this.uiManager;if(t.File&&t.FileReader&&t.FileList&&t.Blob){var i=document.createElement("input");i.type="file",i.accept=".ows",i.addEventListener("change",(function(t){var i=t.target.files[0],s=new FileReader;s.addEventListener("load",(function(t){var i=t.target.result;e.load(i)})),s.readAsText(i,"utf8")})),i.click()}else alert("The File APIs are not fully supported in this browser.")}onSave(){var t=this.uiManager.save(),e="data:application/octet-stream,"+encodeURIComponent(t),i=document.createElement("a");i.download="document.ows",i.href=e,i.target="_blank",i.click()}};ye=n["a"]([Object(r["a"])({components:{StatusBar:Se,SheetSelector:ge,OpenSheet:ce,FormulaBar:It,RibbonMenu:wt}})],ye);var _e=ye,Ae=_e,ke=Object(v["a"])(Ae,o,l,!1,null,null,null),Ee=ke.exports,Ie=i("9483");Object(Ie["a"])("service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),s["a"].config.productionTip=!1,new s["a"]({render:t=>t(Ee)}).$mount("#app")},d2ec:function(t,e,i){"use strict";var s=i("2d04"),o=i.n(s);o.a},fd03:function(t,e,i){}});
//# sourceMappingURL=app.d413334a.js.map