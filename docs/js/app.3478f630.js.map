{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/ControlBox.vue?05f7","webpack:///./src/components/Ribbon.vue?26cb","webpack:///./src/RibbonMenu.vue?6fac","webpack:///./src/OpenSheet.vue?302b","webpack:///./src/components/ActionGroup.vue?d128","webpack:///./src/FormulaBar.vue?117b","webpack:///./src/lib/core/formula/Evaluator.ts","webpack:///./src/components/ColorPicker.vue?893d","webpack:///./src/components/CellBorderStyle.vue?2507","webpack:///./src/components/ActionButton.vue?0927","webpack:///./src/App.vue?1629","webpack:///./src/RibbonMenu.vue?5522","webpack:///./src/components/Ribbon.vue?32ec","webpack:///./src/components/Ribbon.vue?b53c","webpack:///./src/components/Ribbon.vue?cede","webpack:///./src/components/Ribbon.vue","webpack:///./src/components/ControlBox.vue?a699","webpack:///./src/components/ControlBox.vue?82d6","webpack:///./src/components/ControlBox.vue?2f2c","webpack:///./src/components/ControlBox.vue","webpack:///./src/components/CellBorderStyle.vue?360a","webpack:///./src/components/CellBorderStyle.vue?7aa2","webpack:///./src/components/CellBorderStyle.vue?fab7","webpack:///./src/components/CellBorderStyle.vue","webpack:///./src/components/FontSizeSelector.vue?10ca","webpack:///./src/components/FontSizeSelector.vue?b442","webpack:///./src/components/FontSizeSelector.vue?37f2","webpack:///./src/components/FontSizeSelector.vue","webpack:///./src/components/ActionGroup.vue?0ce5","webpack:///./src/components/ActionButton.vue?ab4a","webpack:///./src/components/ActionButton.vue?8270","webpack:///./src/components/ActionButton.vue?ec0a","webpack:///./src/components/ActionButton.vue","webpack:///./src/components/ActionGroup.vue?803c","webpack:///./src/components/ActionGroup.vue?8c07","webpack:///./src/components/ActionGroup.vue","webpack:///./src/components/ColorPicker.vue?609c","webpack:///./src/components/ColorPicker.vue?d0c2","webpack:///./src/lib/core/Appearance.ts","webpack:///./src/components/ColorPicker.vue?8049","webpack:///./src/components/ColorPicker.vue","webpack:///./src/components/FontNameSelector.vue?fca6","webpack:///./src/components/FontNameSelector.vue?d6d6","webpack:///./src/components/FontNameSelector.vue?491e","webpack:///./src/components/FontNameSelector.vue","webpack:///./src/RibbonMenu.vue?22cb","webpack:///./src/RibbonMenu.vue?490c","webpack:///./src/RibbonMenu.vue","webpack:///./src/FormulaBar.vue?0a7b","webpack:///./src/FormulaBar.vue?076b","webpack:///./src/FormulaBar.vue?08ff","webpack:///./src/FormulaBar.vue","webpack:///./src/OpenSheet.vue?61db","webpack:///./src/lib/core/Cell.ts","webpack:///./src/lib/common/constants.ts","webpack:///./src/lib/core/Sheet.ts","webpack:///./src/lib/common/utils.ts","webpack:///./src/lib/core/Commander.ts","webpack:///./src/lib/rendering/canvas/Context.ts","webpack:///./src/lib/core/Document.ts","webpack:///./src/lib/rendering/canvas/CanvasRendering.ts","webpack:///./src/lib/editor/CellEditor.ts","webpack:///./src/lib/editor/UIHandler.ts","webpack:///./src/lib/editor/DocumentHandler.ts","webpack:///./src/lib/editor/SheetUIHandler.ts","webpack:///./src/lib/editor/ResizeHandler.ts","webpack:///./src/lib/editor/UIHandlerControler.ts","webpack:///./src/lib/UI.ts","webpack:///./src/OpenSheet.vue?8675","webpack:///./src/OpenSheet.vue?e09b","webpack:///./src/OpenSheet.vue","webpack:///./src/SheetSelector.vue?140c","webpack:///src/SheetSelector.vue","webpack:///./src/SheetSelector.vue?ba24","webpack:///./src/SheetSelector.vue","webpack:///./src/StatusBar.vue?c970","webpack:///./src/StatusBar.vue?bccc","webpack:///./src/StatusBar.vue?7f1b","webpack:///./src/StatusBar.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/registerServiceWorker.ts","webpack:///./src/main.ts","webpack:///./src/StatusBar.vue?2f02"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Env","ranges","dataProvider","selector","this","getEvaluatedValue","txt","_M_E_","_R_A_N_G_E_","PI","Math","E","SUM","reduce","x","y","MIN","min","MAX","max","SIN","v","sin","COS","cos","TAN","tan","ASIN","asin","ACOS","acos","ATAN","atan","ASINH","ACOSH","ATANH","ABS","abs","SQRT","sqrt","CBRT","LOG","log","EXP","exp","TRUNC","CEIL","ceil","FLOOR","floor","eval","Evaluator","str","regex","valueRegex","temp","range_index","exec","index","lastIndex","forEach","match","groupIndex","indexOf","replace","ev","Eval","substr","err","_vm","_h","$createElement","_c","_self","attrs","appearance","state","on","onAction","label","onCommit","onAbort","model","callback","$$v","$set","expression","onReady","onChange","staticRenderFns","menu","active","slot","staticClass","staticStyle","$event","fontFamily","fontSize","fontStyle","foreColor","fillColor","textAlignment","onAlign","class","isMerged","toggleMerge","borderColor","onBorderChanged","_v","_l","item","_s","_t","newValue","$emit","required","component","style","display","grid","_e","default","directives","rawName","$$selectedVal","Array","filter","target","options","selected","map","val","_value","selectedSize","multiple","size","domProps","sizes","action","disabled","components","ActionButton","$slots","composing","color","TextAlign","BorderStyle","SolidThin","border","Border","textAlign","Left","fontName","textStyle","toLowerCase","Right","Center","horizontalBorder","verticalBorder","ensureTextStyle","bold","italic","app","Appearance","text","background","from","selectedFamily","family","families","borderStructure","alignment","actionName","args","activeStyle","underline","newSize","newFont","FontFamilySelector","ColorPicker","ActionGroup","FontSizeSelector","CellBorderStyle","ControlBox","Ribbon","formula","_m","newFormula","ref","columnId","rowId","colSpan","rowSpan","reference","_columnId","_rowId","evaluated","evaluatedValue","format","formattedValue","to","update","top","left","bottom","right","cell","Cell","SheetTitleHeight","SheetTitleWidth","ColumnHeaderHeight","RowHeaderWidth","RowDefaultHeight","COLOR_LIGHT","COLOR_1","COLOR_2","COLOR_3","title","defaultAppearance","defaultRowHeight","defaultColumnWidth","columnAppearance","rowAppearance","rowHeight","columnWidth","scrollX","scrollY","change_listeners","selection","single","selectNextRowCell","invalidSelection","selectNextColumnCell","Sheet","get_columnName","selectPreviousRowCell","selectPreviousColumnCell","test","pos","getColumnIndex","parseInt","parts","split","a","getCellPos","b","res","getCellEvaluatedValue","sum","pwr","st","ch","charCodeAt","getCell","undefined","silent","forceGetCell","startsWith","updateDependees","removeCell","setCellValue","scrollColumn","getColumnWidth","getColumnLeft","scrollRow","getRowHeight","getRowTop","colX","colId","colW","rowY","findColumnIdByX","findRowIdByY","x1","y1","x2","y2","stop","sbottom","sleft","sright","selectedCell","ftop","fbottom","fleft","fright","scroll","height","width","setCell","xcell","cx","row","column","getCellAppearance","col","getColumnAppearance","getRowAppearance","def","handler","ix","measure","setCellAppearance","getCellName","getAppearance","az","columnString","columnNumber","currentLetterNumber","currentLetter","sheet","sh","fill","clone","obj","JSON","parse","stringify","LayoutDirection","doc","history","commands","font","topBorder","noBorder","leftBorder","rightBorder","bottomBorder","outsideBorder","crossBorder","setVertical","setHorizontal","merge","unmerge","alignTextTo","changeValue","delta","alterColumn","alterRow","commandName","has","console","warn","logAppearanceOnlyCommand","horizontal","vertical","sel","Selection","ActiveSheet","historyItem","SelectedAppearance","SelectionData","w","meta","setColumnWidth","h","setRowHeight","logDataOnlyCommand","method","apps","sheets","activeSheetIndex","init","commander","addSheet","addOnChange","cmd","do","save","load","get_right","get_bottom","get_width","get_height","get_left","get_top","ContextMask","context","maskStack","direction","LeftToRight","fillStyle","strokeStyle","strokeSize","contentFillStyle","context2d","lineWidth","trim","measureText","translate","currentMask","cmask","rect","clip","restore","affectPreviousMask","get_directed_x","get_combinedMask","pop","clearRect","applyFill","beginPath","fillRect","applyStroke","strokeRect","stroke","moveTo","lineTo","close","points","path","point","drpx","drx","closePath","internalPath","applyContent","textWidth","get_textWidth","fillText","grd","createLinearGradient","stops","addColorStop","container","document","rendering","renderFrameRate","initialize","render","createElements","resize","canvas","createElement","appendChild","pixelRatio","devicePixelRatio","clientWidth","clientHeight","getContext","scale","setTimeout","doRender","get_context2D","renderSheetTitles","renderSheet","cornerWidth","fillClosePath","renderTopCorner","rHeight","createGradient","Sheets","sheetWidth","getWidth","line","sheetTitleHeight","maskHeight","setMask","lastRow","renderRows","lastColumn","renderColumns","unmask","renderCells","cumulativeHeight","rw","paintRow","toString","cumulativeWidth","cl","paintColumn","cellHeight","getCellHeight","cellWidth","getCellWidth","paintCell","horStyle","verStyle","controler","editMode","websheet","select","editorArea","position","overflow","renderer","Element","selectionElement","transitionDuration","editorElement","type","zIndex","textIndent","anchorElement","borderRadius","cursor","SelectedValue","Value","updateEditorAppearance","getCurrentCell","IsDirty","execCommand","getCurrentAppearance","getTextAlign","fontWeight","textDecoration","animation","enableAnimation","disableAnimation","getColumnRight","getRowBottom","editorY","editorX","focus","readOnly","controller","dx","dy","evt","lock","unlock","locked","changeActiveSheet","wheelDeltaX","wheelDeltaY","scrollRight","scrollLeft","scrollUp","scrollDown","oldX","oldY","selectCell","EditMode","commit","shiftKey","deselect","preventDefault","selectByXY","engaged","hitColumn","hitRow","changeCursor","resetCursor","rowH","handlers","lockedOn","cellEditor","addHandlers","attachEvents","uiHandler","element","overlay","getXY","offsetX","layerX","clientX","offsetLeft","offsetY","layerY","clientY","offsetTop","addEventListener","mouseDown","mouseMove","mouseUp","click","dblClick","mouseWheel","stopPropagation","keyDown","keyPress","keyUp","ActiveSheetIndex","uiController","raiseOnChangeEventListener","SelectionLabel","command","ui","execCmd","$refs","addOnChangeEventListener","originalValue","uiManager","onLoad","onSave","win","File","FileReader","FileList","Blob","f","accept","file","reader","loadEvt","rawData","readAsText","alert","content","uriContent","encodeURIComponent","href","StatusBar","SheetSelector","OpenSheet","FormulaBar","RibbonMenu","ready","registered","cached","updatefound","updated","offline","error","config","productionTip","$mount"],"mappings":"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","file":"js/app.3478f630.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=style&index=0&id=6cc71dba&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=style&index=0&id=6cc71dba&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=style&index=0&id=10024f8e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=style&index=0&id=10024f8e&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=style&index=0&id=874fae8c&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=style&index=0&id=874fae8c&scoped=true&lang=css&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=style&index=0&id=7e3de4f0&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=style&index=0&id=7e3de4f0&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=style&index=0&id=4be1bd7a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=style&index=0&id=4be1bd7a&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=style&index=0&id=f3fdd5ca&lang=scss&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=style&index=0&id=f3fdd5ca&lang=scss&scoped=true&\"","export interface IDateProvider {\n  getEvaluatedValue(key: string): any;\n}\n\n\nclass Env {\n  constructor(private ranges: any, private dataProvider: any) {\n  }\n\n  private data(selector: any) {\n    return this.dataProvider.getEvaluatedValue(selector);\n  }\n\n  public Eval(txt: string) {\n    let _M_E_ = this;\n    let _R_A_N_G_E_ = this.ranges;\n\n    const PI = Math.PI;\n    const E = Math.E;\n\n    function SUM(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => x * 1 + y * 1, 0);\n    }\n\n    function MIN(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => Math.min(x * 1, y * 1), 0);\n    }\n\n    function MAX(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => Math.max(x * 1, y * 1), 0);\n    }\n\n    function SIN(v: number) {\n      return Math.sin(v);\n    }\n\n    function COS(v: number) {\n      return Math.cos(v);\n    }\n\n    function TAN(v: number) {\n      return Math.tan(v);\n    }\n\n    function ASIN(v: number) {\n      return Math.asin(v);\n    }\n\n    function ACOS(v: number) {\n      return Math.acos(v);\n    }\n\n    function ATAN(v: number) {\n      return Math.atan(v);\n    }\n\n    function ASINH(v: number) {\n      return Math['asinh'](v);\n    }\n\n    function ACOSH(v: number) {\n      return Math['acosh'](v);\n    }\n\n    function ATANH(v: number) {\n      return Math['atanh'](v);\n    }\n\n    function ABS(v: number) {\n      return Math.abs(v);\n    }\n\n    function SQRT(v: number) {\n      return Math.sqrt(v);\n    }\n\n    function CBRT(v: number) {\n      return Math['cbrt'](v);\n    }\n\n    function LOG(v: number) {\n      return Math.log(v);\n    }\n\n    function EXP(v: number) {\n      return Math.exp(v);\n    }\n\n    function TRUNC(v: number) {\n      return Math['trunc'](v);\n    }\n\n    function CEIL(v: number) {\n      return Math.ceil(v);\n    }\n\n    function FLOOR(v: number) {\n      return Math.floor(v);\n    }\n\n\n    return eval(txt);\n  }\n}\n\nexport class Evaluator {\n\n\n  private static valueRegex = /(([a-zA-Z]+[0-9])+\\:?([a-zA-Z]+[0-9]+)?)/g;\n\n  public static Eval(dataProvider: IDateProvider, str: string) {\n    if (str.length < 1 || str[0] != '=') {\n      return str;\n    }\n\n    let m;\n    let regex = this.valueRegex;\n    let temp = str;\n\n    let ranges: any[] = [];\n    let range_index = 0;\n    while ((m = regex.exec(str)) !== null) {\n      // This is necessary to avoid infinite loops with zero-width matches\n      if (m.index === regex.lastIndex) {\n        regex.lastIndex++;\n      }\n\n      m.forEach((match, groupIndex) => {\n        if (match && match.indexOf(':') != -1) {\n          ranges.push(match);\n          temp = temp.replace(match + '', `_R_A_N_G_E_[${range_index++}]`);\n        } else if (groupIndex == 0) {\n          let ev = dataProvider.getEvaluatedValue(match);\n          temp = temp.replace(match, ev);\n        }\n      });\n    }\n\n    try {\n      return new Env(ranges, dataProvider).Eval(temp.substr(1));\n    } catch (err) {\n      return '#ERR';\n    }\n\n  }\n\n\n}\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=57c2e5d6&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=57c2e5d6&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=style&index=0&id=69596444&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=style&index=0&id=69596444&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=style&index=0&id=7102f9e3&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=style&index=0&id=7102f9e3&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('ribbon-menu',{attrs:{\"appearance\":_vm.appearance,\"state\":_vm.state},on:{\"action\":_vm.onAction}}),_c('formula-bar',{attrs:{\"label\":_vm.state.label},on:{\"commit\":_vm.onCommit,\"abort\":_vm.onAbort},model:{value:(_vm.state.value),callback:function ($$v) {_vm.$set(_vm.state, \"value\", $$v)},expression:\"state.value\"}}),_c('open-sheet',{on:{\"ready\":_vm.onReady,\"change\":_vm.onChange}}),_c('status-bar')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ribbon',{attrs:{\"menu\":_vm.menu},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},[_c('div',{attrs:{\"slot\":\"menu-home\"},slot:\"menu-home\"},[_c('control-box',{staticClass:\"last\",attrs:{\"label\":\"Document\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"padding\":\"10px 5px\",\"text-align\":\"center\"}},[_c('i',{staticClass:\"far fa-save xx-large-font flat-button\",on:{\"click\":function($event){return _vm.onAction('save-ows')}}}),_c('span',{staticClass:\"seperator\"}),_c('i',{staticClass:\"far fa-folder xx-large-font flat-button\",on:{\"click\":function($event){return _vm.onAction('load-ows')}}})])]),_c('control-box',{staticClass:\"independent\",attrs:{\"label\":\"Font\"}},[_c('p',[_c('font-family-selector',{model:{value:(_vm.fontFamily),callback:function ($$v) {_vm.fontFamily=$$v},expression:\"fontFamily\"}}),_c('font-size-selector',{model:{value:(_vm.fontSize),callback:function ($$v) {_vm.fontSize=$$v},expression:\"fontSize\"}})],1),_c('p',[_c('action-group',{staticStyle:{\"float\":\"left\",\"margin-right\":\"15px\"},attrs:{\"value\":_vm.fontStyle},on:{\"action\":_vm.onAction}},[_c('i',{staticClass:\"fa fa-bold\",attrs:{\"slot\":\"bold\"},slot:\"bold\"}),_c('i',{staticClass:\"fa fa-italic\",attrs:{\"slot\":\"italic\"},slot:\"italic\"}),_c('i',{staticClass:\"fa fa-underline\",attrs:{\"slot\":\"underline\"},slot:\"underline\"})]),_c('color-picker',{model:{value:(_vm.foreColor),callback:function ($$v) {_vm.foreColor=$$v},expression:\"foreColor\"}},[_c('i',{staticClass:\"fas fa-palette\"})])],1)]),_c('control-box',{staticClass:\"last\",attrs:{\"label\":\"Format\"}},[_c('p',[_c('color-picker',{attrs:{\"label\":\"Fill color\"},model:{value:(_vm.fillColor),callback:function ($$v) {_vm.fillColor=$$v},expression:\"fillColor\"}},[_c('i',{staticClass:\"fa fa-fill\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_c('p',[_c('action-group',{attrs:{\"value\":_vm.textAlignment},on:{\"action\":_vm.onAlign}},[_c('i',{staticClass:\"fa fa-align-left\",attrs:{\"slot\":\"left\"},slot:\"left\"}),_c('i',{staticClass:\"fa fa-align-center\",attrs:{\"slot\":\"center\"},slot:\"center\"}),_c('i',{staticClass:\"fa fa-align-right\",attrs:{\"slot\":\"right\"},slot:\"right\"})])],1)]),_c('control-box',{staticClass:\"independent\",attrs:{\"label\":\"Cell\"}},[_c('p',[_c('action-button',{class:{on:_vm.state.isMerged},attrs:{\"label\":\"Merge\"},on:{\"click\":_vm.toggleMerge}},[_c('i',{staticClass:\"fa fa-th\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_c('p',[_c('color-picker',{attrs:{\"label\":\"Border\"},model:{value:(_vm.borderColor),callback:function ($$v) {_vm.borderColor=$$v},expression:\"borderColor\"}})],1)]),_c('control-box',{attrs:{\"label\":\"Borders\"}},[_c('cell-border-style',{on:{\"change\":_vm.onBorderChanged}})],1)],1),_c('div',{attrs:{\"slot\":\"menu-formulas\"},slot:\"menu-formulas\"},[_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Mathematical\"}}),_c('control-box',{staticClass:\"last\",staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Statistics\"}}),_c('control-box',{staticClass:\"independent\",staticStyle:{\"flex\":\"3\"},attrs:{\"label\":\"User Defined Functions\"}})],1),_c('div',{attrs:{\"slot\":\"menu-data\"},slot:\"menu-data\"},[_c('control-box',{attrs:{\"label\":\"File\"}},[_c('div',{staticStyle:{\"margin\":\"10px 20px\"}},[_c('i',{staticClass:\"fa fa-file-excel\",staticStyle:{\"font-size\":\"xx-large\"}})])]),_c('control-box',{attrs:{\"label\":\"Open Office\"}},[_c('action-group',{attrs:{\"value\":[{name:'import',label:'Import'},{name:'export',label:'Export'}]}})],1),_c('control-box',{staticClass:\"last\",staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"MS Excel\"}},[_c('action-group',{attrs:{\"value\":[{name:'import',label:'Import'},{name:'export',label:'Export'}]}})],1),_c('control-box',{staticStyle:{\"flex\":\"4\"},attrs:{\"label\":\"3rd Parties\"}})],1),_c('div',{attrs:{\"slot\":\"menu-view\"},slot:\"menu-view\"},[_c('control-box',{attrs:{\"label\":\"Print\"}},[_c('div',{staticStyle:{\"margin\":\"5px 20px\"}},[_c('i',{staticClass:\"fa fa-print\",staticStyle:{\"font-size\":\"xx-large\"}})])]),_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Layout\"}})],1),_c('div',{staticStyle:{\"flex\":\"1\"},attrs:{\"slot\":\"menu-info\"},slot:\"menu-info\"},[_c('control-box',{attrs:{\"label\":\"OSI\"}},[_c('span',{staticStyle:{\"font-size\":\"xx-large\",\"color\":\"#00454d\",\"font-weight\":\"bold\"}},[_c('i',{staticClass:\"fab fa-osi\"})])]),_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"About Open Web Sheet Project\",\"grid\":false}},[_c('span',{staticStyle:{\"flex\":\"1\"}},[_vm._v(\" Designed and developed by \"),_c('strong',[_vm._v(\"Siamand Maroufi\")]),_c('br'),_vm._v(\" 3rd Parties: \"),_c('strong',[_vm._v(\"FontAwesome Icons\")]),_vm._v(\" & \"),_c('strong',[_vm._v(\"Google noto web font\")]),_c('br'),_vm._v(\" Licence: \"),_c('strong',[_vm._v(\"MIT Licence\")])]),_c('span',{staticStyle:{\"align-self\":\"flex-start\"}},[_c('a',{attrs:{\"href\":\"https://siamand.cc\"}},[_c('i',{staticClass:\"fa fa-link\"}),_vm._v(\" Developer's site\")]),_vm._v(\" | \"),_c('a',{attrs:{\"href\":\"https://github.com/SiamandMaroufi/OpenWebSheet\"}},[_c('i',{staticClass:\"fab fa-github\"}),_vm._v(\" Source Code\")])])])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ribbon-menu\"},[_c('ul',{staticClass:\"menu\",attrs:{\"data-qa\":\"menu\"}},_vm._l((_vm.menu),function(item){return _c('li',{key:item.name,staticClass:\"menu-label\",class:{'active':_vm.active===item.name},attrs:{\"data-qa\":item},on:{\"click\":function($event){_vm.active = item.name}}},[_vm._v(\" \"+_vm._s(item.label)+\" \")])}),0),_c('div',{staticClass:\"menu-content\"},_vm._l((_vm.menu),function(item){return _c('div',{key:item.name,staticClass:\"menu-content-item\",class:{'active': (_vm.active === item.name)}},[_vm._t(item.name,[_c('fieldset',[_c('legend',[_vm._v(_vm._s(item.label))]),_c('span',{staticClass:\"default-place-holder\"},[_vm._v(\"placeholder for \"+_vm._s(item.name))])])])],2)}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Prop, Vue } from \"vue-property-decorator\"\nimport { RibbonMenuItem } from \"@/components/RibbonMenu\"\n\n@Component({name: \"Ribbon\"})\nexport default class Ribbon extends Vue {\n  @Prop({required: true})\n  value!: string;\n\n  @Prop({required: true})\n  menu!: RibbonMenuItem[];\n\n  get active() {\n    return this.value\n  }\n\n  set active(newValue) {\n    this.$emit('input', newValue)\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Ribbon.vue?vue&type=template&id=10024f8e&scoped=true&\"\nimport script from \"./Ribbon.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ribbon.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Ribbon.vue?vue&type=style&index=0&id=10024f8e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10024f8e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"control-box\"},[_c('div',{staticClass:\"control-box-controls\",style:({display:_vm.grid?'grid':'flex'})},[_vm._t(\"default\")],2),(_vm.label)?_c('div',{staticClass:\"control-box-header\"},[_vm._v(_vm._s(_vm.label))]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\n\n@Component({name: \"ControlBox\"})\nexport default class ControlBox extends Vue {\n  @Prop()\n  label?: string;\n\n  @Prop({default: true})\n  grid!: boolean\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ControlBox.vue?vue&type=template&id=6cc71dba&scoped=true&\"\nimport script from \"./ControlBox.vue?vue&type=script&lang=ts&\"\nexport * from \"./ControlBox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ControlBox.vue?vue&type=style&index=0&id=6cc71dba&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6cc71dba\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cell-border-style\"},[_c('div',{staticClass:\"borders all\",on:{\"click\":function($event){return _vm.$emit('change','full-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders inside\",on:{\"click\":function($event){return _vm.$emit('change','cross-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders horizontal\",on:{\"click\":function($event){return _vm.$emit('change','horizontal-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders vertical\",on:{\"click\":function($event){return _vm.$emit('change','vertical-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders outside\",on:{\"click\":function($event){return _vm.$emit('change','outside-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders left\",on:{\"click\":function($event){return _vm.$emit('change','left-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders top\",on:{\"click\":function($event){return _vm.$emit('change','top-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders right\",on:{\"click\":function($event){return _vm.$emit('change','right-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders bottom\",on:{\"click\":function($event){return _vm.$emit('change','bottom-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders\",on:{\"click\":function($event){return _vm.$emit('change','no-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nexport default {\n  name: 'cell-border-style'\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./CellBorderStyle.vue?vue&type=template&id=69596444&scoped=true&\"\nimport script from \"./CellBorderStyle.vue?vue&type=script&lang=ts&\"\nexport * from \"./CellBorderStyle.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./CellBorderStyle.vue?vue&type=style&index=0&id=69596444&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"69596444\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedSize),expression:\"selectedSize\"}],staticClass:\"font-size\",on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedSize=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.sizes),function(size){return _c('option',{key:size,domProps:{\"value\":size}},[_vm._v(\" \"+_vm._s(size)+\" \")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\n\n@Component({name: 'font-size-selector'})\nexport default class FontSizeSelector extends Vue {\n  @Prop({default: 12})\n  value!: number;\n\n  sizes = [6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 20, 22, 24, 26, 28, 32, 36, 48, 72]\n\n  get selectedSize() {\n    return this.value\n  }\n\n  set selectedSize(newValue: number) {\n    this.$emit('input', newValue)\n    this.$emit('change', newValue)\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontSizeSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontSizeSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FontSizeSelector.vue?vue&type=template&id=46dadc9c&\"\nimport script from \"./FontSizeSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FontSizeSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"action-group\"},_vm._l((_vm.actions),function(action){return _c('action-button',{key:action.name,staticClass:\"action-group-item\",class:{'on':action.selected},attrs:{\"disabled\":action.disabled},on:{\"click\":function($event){return _vm.$emit('action',action.name)}}},[_vm._t(action.name,[_vm._v(\" \"+_vm._s(action.label)+\" \")])],2)}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"action\",attrs:{\"disabled\":_vm.disabled},on:{\"click\":function($event){return _vm.$emit('click')}}},[_vm._t(\"default\",[_vm._t(\"prefix\"),_vm._v(\" \"+_vm._s(_vm.label)+\" \"),_vm._t(\"postfix\")])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\n\n@Component({name: \"ActionButton\"})\nexport default class ActionButton extends Vue {\n  @Prop()\n  label?: string;\n\n  @Prop({default: false})\n  disabled!: boolean;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ActionButton.vue?vue&type=template&id=7102f9e3&scoped=true&\"\nimport script from \"./ActionButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./ActionButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ActionButton.vue?vue&type=style&index=0&id=7102f9e3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7102f9e3\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\nimport Action from './Action';\nimport ActionButton from \"@/components/ActionButton.vue\"\n\n\n@Component({\n  name: \"ActionGroup\",\n  components: {ActionButton}\n})\nexport default class ActionGroup extends Vue {\n  @Prop({required: true})\n  value!: Action[];\n\n  get actions() {\n    return this.value\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ActionGroup.vue?vue&type=template&id=4be1bd7a&scoped=true&\"\nimport script from \"./ActionGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./ActionGroup.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ActionGroup.vue?vue&type=style&index=0&id=4be1bd7a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4be1bd7a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"color-picker\"},[_c('label',[_vm._t(\"default\",[(!!_vm.$slots['prefix'])?_c('span',{staticClass:\"prefix\"},[_vm._t(\"prefix\")],2):_vm._e(),_vm._v(\" \"+_vm._s(_vm.label)+\" \"),_vm._t(\"postfix\")])],2),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.color),expression:\"color\"}],attrs:{\"type\":\"color\",\"id\":\"bg-color\"},domProps:{\"value\":(_vm.color)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.color=$event.target.value}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\n\n@Component({name: \"ColorPicker\"})\nexport default class ColorPicker extends Vue {\n  @Prop({default: '#ffffff'})\n  value!: string;\n\n  @Prop()\n  label?: string;\n\n  get color() {\n    if (this.value === null) {\n      return '#ffffff';\n    }\n    return this.value;\n  }\n\n  set color(newValue) {\n    this.$emit('input', newValue)\n  }\n}\n","import { Color } from \"@/lib/common/types\"\n\nexport enum TextAlign {\n  Left,\n  Right,\n  Center\n}\n\nexport enum BorderStyle {\n  SolidThin,\n  SolidThick,\n  SolidDouble,\n  DottedThin,\n  DottedThick,\n  DashedThin,\n  DashedThick,\n  DotDashedThin,\n  DotDashedThick\n}\n\nexport class Border {\n  public constructor(public color: string | null = null) {\n\n  }\n\n  public style: BorderStyle = BorderStyle.SolidThin;\n\n  static from(data: { style: BorderStyle, color: string }): Border {\n    let border = new Border();\n    border.style = data.style;\n    border.color = data.color;\n    return border;\n  }\n}\n\nexport class Appearance {\n  public textAlign: TextAlign = TextAlign.Left;\n  public fontName: string = 'Lato';\n  public fontSize: number = 12;\n  public textStyle: any;\n  public text: any;\n  public background: any;\n  public horizontalBorder?: Border | null;\n  public verticalBorder?: Border | null;\n\n  public get bold() {\n    return !!(this.textStyle && this.textStyle.indexOf('bold') != -1);\n  }\n\n  private ensureTextStyle() {\n    if (!this.textStyle) {\n      this.textStyle = '';\n    }\n  }\n\n  public set bold(value: boolean) {\n    this.ensureTextStyle();\n    if (this.bold == value) return;\n    if (value) this.textStyle = `${this.textStyle} bold`;\n    else this.textStyle = this.textStyle.replace('bold', '');\n  }\n\n  public get italic() {\n    return !!(this.textStyle && this.textStyle.indexOf('italic') != -1);\n  }\n\n  public set italic(value: boolean) {\n    this.ensureTextStyle();\n    if (this.italic == value) return;\n    if (value) this.textStyle = `${this.textStyle} italic`;\n    else this.textStyle = this.textStyle.replace('italic', '');\n  }\n\n  public get underline() {\n    return !!(this.textStyle && this.textStyle.indexOf('underline') != -1);\n  }\n\n  public set underline(value: boolean) {\n    this.ensureTextStyle();\n    if (this.italic == value || !this.textStyle) return;\n    if (value) this.textStyle = `${this.textStyle} underline`;\n    else this.textStyle = this.textStyle.replace('underline', '');\n  }\n\n  alignTextTo(value: string) {\n    if (value.toLowerCase() == \"right\") {\n      this.textAlign = TextAlign.Right;\n    } else if (value.toLowerCase() == \"center\") {\n      this.textAlign = TextAlign.Center;\n    } else if (value.toLowerCase() == \"left\") {\n      this.textAlign = TextAlign.Left;\n    } else {\n      throw `invalid text-align '${value}'`;\n    }\n\n  }\n\n  public setHorizontal(value: Color) {\n    this.horizontalBorder = new Border();\n    this.horizontalBorder.style = BorderStyle.SolidThin;\n    this.horizontalBorder.color = value;\n  }\n\n  public setVertical(value: Color) {\n    this.verticalBorder = new Border();\n    this.verticalBorder.style = BorderStyle.SolidThin;\n    this.verticalBorder.color = value;\n  }\n\n  static from(data: {\n    textAlign: any,\n    textStyle: any,\n    fontName: string,\n    fontSize: number,\n    text: string,\n    background: string,\n    horizontalBorder: any,\n    verticalBorder: any\n  }) {\n    let app = new Appearance();\n    app.textAlign = data.textAlign;\n    app.textStyle = data.textStyle;\n    app.fontName = data.fontName;\n    app.fontSize = data.fontSize;\n    app.text = data.text;\n    app.background = data.background;\n    app.horizontalBorder = data.horizontalBorder && Border.from(data.horizontalBorder);\n    app.verticalBorder = data.verticalBorder && Border.from(data.verticalBorder);\n\n    return app;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ColorPicker.vue?vue&type=template&id=57c2e5d6&scoped=true&\"\nimport script from \"./ColorPicker.vue?vue&type=script&lang=ts&\"\nexport * from \"./ColorPicker.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ColorPicker.vue?vue&type=style&index=0&id=57c2e5d6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57c2e5d6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedFamily),expression:\"selectedFamily\"}],staticClass:\"font-family\",on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedFamily=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.families),function(family){return _c('option',{key:family,domProps:{\"value\":family}},[_vm._v(\" \"+_vm._s(family)+\" \")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\n\n@Component({name: 'font-family-selector'})\nexport default class FontFamilySelector extends Vue {\n  @Prop({default: 'Lato'})\n  value!: string;\n\n  families = ['Lato','Sans','Serif','Courier','Courier New']\n\n  get selectedFamily() {\n    return this.value\n  }\n\n  set selectedFamily(newValue: string) {\n    this.$emit('input', newValue)\n    this.$emit('change', newValue)\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontNameSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontNameSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FontNameSelector.vue?vue&type=template&id=4a1bd293&\"\nimport script from \"./FontNameSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FontNameSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\nimport { RibbonMenuItem } from \"@/components/RibbonMenu\"\nimport Ribbon from \"@/components/Ribbon.vue\"\nimport ControlBox from \"@/components/ControlBox.vue\"\nimport CellBorderStyle from \"@/components/CellBorderStyle.vue\"\nimport FontSizeSelector from \"@/components/FontSizeSelector.vue\"\nimport ActionGroup from \"@/components/ActionGroup.vue\"\nimport ColorPicker from \"@/components/ColorPicker.vue\"\nimport ActionButton from \"@/components/ActionButton.vue\"\nimport { Appearance, TextAlign } from \"@/lib/core/Appearance\"\nimport FontFamilySelector from \"@/components/FontNameSelector.vue\"\nimport { Color } from \"@/lib/common/types\"\n\n@Component({\n  name: \"RibbonMenu\",\n  components: {\n    FontFamilySelector,\n    ActionButton, ColorPicker, ActionGroup, FontSizeSelector, CellBorderStyle, ControlBox, Ribbon\n  }\n})\nexport default class RibbonMenu extends Vue {\n  active = 'menu-home';\n\n  @Prop()\n  appearance!: Appearance\n\n  @Prop({default: () => ({isMerged: true})})\n  state!: { isMerged: boolean }\n\n  borderColor: Color = 'black';\n\n  get activeStyle() {\n    return this.appearance || new Appearance()\n  }\n\n  get textAlignment() {\n    return [\n      {\n        name: 'left',\n        selected: this.activeStyle.textAlign === TextAlign.Left\n      },\n      {\n        name: 'center',\n        selected: this.activeStyle.textAlign === TextAlign.Center\n      },\n      {\n        name: 'right',\n        selected: this.activeStyle.textAlign === TextAlign.Right\n      }\n    ]\n  }\n\n  get fontStyle() {\n    return [\n      {name: 'bold', selected: this.activeStyle.bold},\n      {name: 'italic', selected: this.activeStyle.italic},\n      {name: 'underline', selected: this.activeStyle.underline}\n    ]\n  }\n\n  onBorderChanged(borderStructure: string) {\n    this.onAction(borderStructure, this.borderColor)\n  }\n\n  onAlign(alignment: string) {\n    this.onAction('align', alignment)\n  }\n\n  get foreColor() {\n    return this.activeStyle.text\n  }\n\n  set foreColor(color: string) {\n    this.onAction('fg-color', color)\n  }\n\n  get fillColor() {\n    return this.activeStyle.background\n  }\n\n  set fillColor(color: string) {\n    this.onAction('bg-color', color)\n  }\n\n  get fontSize() {\n    return this.activeStyle.fontSize\n  }\n\n  set fontSize(newSize: number) {\n    this.onAction('font-size', newSize)\n  }\n\n  get fontFamily() {\n    return this.activeStyle.fontName\n  }\n\n  set fontFamily(newFont: string) {\n    this.onAction('font-name', newFont)\n  }\n\n  toggleMerge() {\n    this.onAction(this.state.isMerged ? 'unmerge' : 'merge')\n  }\n\n  onAction(actionName: string, args?: any) {\n    this.$emit('action', {actionName, args})\n  }\n\n  menu: RibbonMenuItem[] = [\n    {name: 'menu-home', label: 'Home'},\n    {name: 'menu-formulas', label: 'Formulas'},\n    {name: 'menu-data', label: 'Data'},\n    {name: 'menu-view', label: 'View'},\n    {name: 'menu-info', label: 'About'}\n  ]\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./RibbonMenu.vue?vue&type=template&id=874fae8c&scoped=true&\"\nimport script from \"./RibbonMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./RibbonMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./RibbonMenu.vue?vue&type=style&index=0&id=874fae8c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"874fae8c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"formula-bar\",class:{active: _vm.active}},[_c('input',{staticClass:\"cell-name\",attrs:{\"type\":\"text\",\"placeholder\":\"SELECTION\"},domProps:{\"value\":_vm.label}}),_c('span',{staticClass:\"side\"},[_c('span',{staticClass:\"actions\"},[_c('i',{staticClass:\"fa fa-times cancel\",on:{\"click\":function($event){return _vm.$emit('abort')}}}),_c('i',{staticClass:\"fa fa-check commit\",on:{\"click\":function($event){return _vm.$emit('commit')}}})]),_vm._v(\" 𝑓𝑥 \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.formula),expression:\"formula\"}],staticClass:\"formula\",attrs:{\"id\":\"formula-input\",\"type\":\"text\"},domProps:{\"value\":(_vm.formula)},on:{\"focusin\":function($event){_vm.active=true},\"focusout\":function($event){_vm.active=false},\"input\":function($event){if($event.target.composing){ return; }_vm.formula=$event.target.value}}}),_vm._m(0)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"arrow\"},[_c('i',{staticClass:\"fas fa-angle-down\"})])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from \"vue-property-decorator\"\nimport Vue from 'vue';\n\n@Component({name: \"FormulaBar\"})\nexport default class FormulaBar extends Vue {\n  active = false\n\n  @Prop()\n  value!: string;\n\n  @Prop()\n  label!: string\n\n  get formula() {\n    return this.value;\n  }\n\n  set formula(newFormula: string) {\n    this.$emit('input', newFormula);\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FormulaBar.vue?vue&type=template&id=f3fdd5ca&scoped=true&\"\nimport script from \"./FormulaBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./FormulaBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FormulaBar.vue?vue&type=style&index=0&id=f3fdd5ca&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f3fdd5ca\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"canvas-container\",staticClass:\"open-sheet\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class Cell {\n  public colSpan: number = 1;\n  public rowSpan: number = 1;\n\n  private formattedValue?: string;\n  private evaluatedValue?: string;\n  private _columnId: number;\n  private _rowId: number;\n  private _value: any = null;\n\n  public constructor(columnId: number, rowId: number) {\n    this._columnId = columnId;\n    this._rowId = rowId;\n  }\n\n  // merged cell has following value\n  public reference: Cell | null = null;\n\n  public get isMerged() {\n    return this.reference !== null;\n  }\n\n  public get columnId() {\n    return this._columnId;\n  }\n\n  public get rowId() {\n    return this._rowId;\n  }\n\n  public get label() {\n    return this.formattedValue;\n  }\n\n  public get value() {\n    return this._value;\n  }\n\n  public set value(newValue) {\n    this.update(newValue, newValue);\n  }\n\n  public get top(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.top\n    }\n\n    return this.rowId;\n  }\n\n  public get left(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.left\n    }\n\n    return this.columnId\n  }\n\n  public get bottom(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.bottom\n    }\n\n    return this.rowId + this.rowSpan\n  }\n\n  public get right(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.right\n    }\n\n    return this.columnId + this.colSpan\n  }\n\n  public update(newValue: any, evaluated: any): void {\n    this._value = newValue;\n    this.evaluatedValue = evaluated;\n    this.format();\n  }\n\n  private format() {\n    this.formattedValue = this.evaluatedValue;\n  }\n\n  static from(data: any): Cell {\n    let cell = new Cell(data.columnId, data.rowId);\n    cell.colSpan = data.colSpan;\n    cell.rowSpan = data.rowSpan;\n    cell.formattedValue = data.formattedValue;\n    cell.evaluatedValue = data.evaluatedValue;\n    cell._columnId = data._columnId;\n    cell._rowId = data._rowId;\n    cell._value = data._value;\n    cell.reference = data.reference && this.from(data.reference);\n    return cell;\n  }\n\n  to(): any {\n    return {\n      colSpan: this.colSpan,\n      rowSpan: this.rowSpan,\n      formattedValue: this.formattedValue,\n      evaluatedValue: this.evaluatedValue,\n      _columnId: this._columnId,\n      _rowId: this._rowId,\n      _value: this._value,\n      reference: this.reference && this.reference.to()\n    };\n  }\n}\n","export const SheetTitleHeight:number = 30;\nexport const SheetTitleWidth:number= 110;\nexport const ColumnHeaderHeight:number = 30;\nexport const ColumnDefaultWidth:number = 100;\nexport const RowHeaderWidth:number = 30;\nexport const RowDefaultHeight:number = 30;\n\nexport const COLOR_LIGHT = '#fff';\nexport const COLOR_GRAY  = '#ccc';\nexport const COLOR_LIGHT_GRAY  = '#fafafa';\nexport const COLOR_CREAM = '#fffdd0';\nexport const COLOR_0 ='#4CAF50';\nexport const COLOR_1 ='#00897b';\nexport const COLOR_2 ='#00796b';\nexport const COLOR_3 ='#00454d';\n","import { Cell } from \"./Cell\";\nimport { Appearance, Border } from \"./Appearance\";\nimport { ColumnDefaultWidth, RowDefaultHeight, SheetTitleWidth } from \"../common/constants\";\nimport { Evaluator, IDateProvider } from \"./formula/Evaluator\";\n\n\nexport class CellSelection {\n  public left: number = 0;\n  public top: number = 0;\n  public right: number = 0;\n  public bottom: number = 0;\n\n  public rowId: number = 0;\n  public columnId: number = 0;\n\n  public get single() {\n    return this.right == this.left && this.top == this.bottom\n  }\n\n  public toString() {\n    return `${this.top} ${this.left} - ${this.bottom} ${this.right}`;\n  }\n}\n\nexport class Sheet implements IDateProvider {\n\n  private data: any[] = [];\n  public defaultAppearance: Appearance = new Appearance();\n  public defaultRowHeight = 30;\n  public defaultColumnWidth = 100;\n  private appearance: any[] = [];\n  private columnAppearance: Appearance[] = [];\n  private rowAppearance: Appearance[] = [];\n  private rowHeight: number[] = [];\n  private columnWidth: number[] = []\n  private scrollX: number = 0;\n  private scrollY: number = 0;\n  public selection: CellSelection;\n  private change_listeners: (() => void)[] = [];\n\n  constructor(public title: string) {\n    this.defaultAppearance.background = null;\n    this.defaultAppearance.fontName = 'Lato';\n    this.defaultAppearance.fontSize = 12;\n    this.defaultAppearance.horizontalBorder = null;\n    this.defaultAppearance.verticalBorder = null;\n    this.defaultAppearance.text = '#333333';\n\n\n    this.selection = new CellSelection();\n    this.selection.top = 0;\n    this.selection.left = 0;\n    this.selection.right = 0;\n    this.selection.bottom = 0;\n    this.selection.rowId = 0;\n    this.selection.columnId = 0;\n  }\n\n  selectNextColumnCell() {\n    this.selection.columnId++;\n\n    if (this.selection.single) {\n      this.selection.right = this.selection.columnId;\n      this.selection.left = this.selection.columnId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.columnId > this.selection.right) {\n      this.selection.columnId = this.selection.left;\n      if (this.selection.rowId == this.selection.bottom) {\n        this.selection.rowId = this.selection.top;\n      } else {\n        this.selectNextRowCell();\n      }\n\n    }\n\n    if (this.invalidSelection) this.selectNextColumnCell();\n    this.onChange();\n  }\n\n  private getCellName(columnId: number, rowId: number) {\n    return `${Sheet.get_columnName(columnId)}${rowId + 1}`;\n  }\n\n  public get SelectionLabel() {\n    return this.getCellName(this.selection.columnId, this.selection.rowId);\n  }\n\n  public get SelectedValue() {\n    return this.selectedCell && this.selectedCell.value;\n  }\n\n  public get SelectedAppearance() {\n    return this.getAppearance(this.selection.columnId, this.selection.rowId);\n  }\n\n  selectPreviousColumnCell() {\n    if (this.selection.columnId == 0) return;\n    this.selection.columnId--;\n\n    if (this.selection.single) {\n      this.selection.right = this.selection.columnId;\n      this.selection.left = this.selection.columnId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.columnId < this.selection.left) {\n      this.selection.columnId = this.selection.right;\n      if (this.selection.rowId == this.selection.top) {\n        this.selection.rowId = this.selection.bottom;\n      } else {\n        this.selectPreviousRowCell();\n      }\n    }\n\n    if (this.invalidSelection) this.selectPreviousColumnCell();\n    this.onChange();\n  }\n\n  get selectedCell() {\n    return this.getCell(this.selection.columnId, this.selection.rowId);\n  }\n\n  private get invalidSelection() {\n    return this.selectedCell && this.selectedCell.isMerged;\n  }\n\n  selectNextRowCell() {\n\n    this.selection.rowId++;\n    if (this.selection.single) {\n      this.selection.top = this.selection.rowId;\n      this.selection.bottom = this.selection.rowId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.rowId > this.selection.bottom) {\n      this.selection.rowId = this.selection.top;\n      if (this.selection.columnId == this.selection.right) {\n        this.selection.columnId = this.selection.left;\n      } else {\n        this.selectNextColumnCell();\n      }\n    }\n\n    if (this.invalidSelection) this.selectNextRowCell();\n    this.onChange();\n  }\n\n  selectPreviousRowCell() {\n    if (this.selection.rowId == 0) return;\n    this.selection.rowId--;\n    if (this.selection.single) {\n      this.selection.top = this.selection.rowId;\n      this.selection.bottom = this.selection.rowId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.rowId < this.selection.top) {\n      this.selection.rowId = this.selection.bottom;\n      if (this.selection.columnId == this.selection.left) {\n        this.selection.columnId = this.selection.right;\n      } else {\n        this.selectPreviousColumnCell();\n      }\n    }\n\n    if (this.invalidSelection) this.selectPreviousRowCell();\n    this.onChange();\n  }\n\n  private getCellPos(name: string) {\n    const regex = /([a-zA-z]+)([0-9]+)/g;\n    if (!(/([a-zA-z]+)([0-9]+)/g).test(name)) {\n      throw 'invalid cell name ' + name;\n    }\n    const pos: any = regex.exec(name);\n    const columnId = this.getColumnIndex(pos[1]);\n    const rowId = parseInt(pos[2]) - 1;\n\n    return {rowId: rowId, columnId: columnId};\n  }\n\n  getEvaluatedValue(exp: any): any[] {\n    if (('' + exp).indexOf(':') != -1) {\n      const parts = exp.split(':');\n      const a = this.getCellPos(parts[0]);\n      const b = this.getCellPos(parts[1]);\n      let res = [];\n      for (let c = a.columnId; c <= b.columnId; c++) {\n        for (let r = a.rowId; r <= b.rowId; r++) {\n          res.push(this.getCellEvaluatedValue(c, r));\n        }\n      }\n      return res;\n    }\n\n    let {rowId, columnId} = this.getCellPos(exp);\n    return this.getCellEvaluatedValue(columnId, rowId);\n  }\n\n  private getColumnIndex(name: string) {\n    let sum = 0;\n    let pwr = 1;\n    let st = 65;\n    for (let i = name.length - 1; i >= 0; i--) {\n      const ch = name.charCodeAt(i) - st;\n      sum += ch * pwr;\n      pwr *= 26;\n      st = 64;\n    }\n    return sum;\n  }\n\n  private getCellEvaluatedValue(columnId: number, rowId: number) {\n    const cell = this.getCell(columnId, rowId);\n    if (cell == null) {\n      return null;\n    }\n\n    return Evaluator.Eval(this, cell.value);//TODO: should be cached and check cycles\n\n  }\n\n  removeCell(columnId: number, rowId: number) {\n    if (this.data[columnId] && this.data[columnId][rowId]) {\n      this.data[columnId][rowId] = undefined;\n    }\n  }\n\n  setCellValue(columnId: number, rowId: number, value: any, silent = false): any {\n    if (value == null) {\n      this.removeCell(columnId, rowId);\n      return;\n    }\n    let cell = this.forceGetCell(columnId, rowId);\n    if (value.startsWith('=')) {\n      let evaluatedValue = Evaluator.Eval(this, value);\n      cell.update(value, evaluatedValue);\n    } else {\n      cell.value = value;\n    }\n    if (!silent) {\n      this.updateDependees(columnId, rowId);\n      this.onChange()\n    }\n  }\n\n  private updateDependees(columnId: number, rowId: number) {\n    //TODO:bad performance\n    for (let d of this.data) {\n      if (!d) continue;\n      for (let c of d) {\n        if (!c || !c.value) continue;\n        if (c.value.length && c.value[0] == '=') {\n          this.setCellValue(c.columnId, c.rowId, c.value, true);\n        }\n      }\n    }\n  }\n\n  getColumnLeft(columnId: number) {\n    let result = 0;\n    for (let i = this.scrollColumn; i < columnId; i++) {\n      result += this.getColumnWidth(i);\n    }\n    return result;\n  }\n\n  getColumnRight(columnId: number) {\n    return this.getColumnLeft(columnId) + this.getColumnWidth(columnId);\n  }\n\n  getRowTop(rowId: number) {\n    let result = 0;\n    for (let i = this.scrollRow; i < rowId; i++) {\n      result += this.getRowHeight(i);\n    }\n    return result;\n  }\n\n  getRowBottom(rowId: number) {\n    return this.getRowTop(rowId) + this.getRowHeight(rowId);\n  }\n\n  findColumnIdByX(x: number) {\n    if (x < 0) return 0;\n    let colX = 0;\n    for (let colId = this.scrollColumn; ; colId++) {\n      if (colId > this.scrollColumn + 100) return 0;\n      let colW = this.getColumnWidth(colId);\n      if (x > colX && x < colX + colW) {\n        return colId;\n      }\n      colX += colW;\n    }\n  }\n\n  findRowIdByY(y: number) {\n    let rowY = this.getRowHeight(this.scrollRow);\n    let rowId = this.scrollRow;\n    while (rowY < y) {\n      rowId++;\n      rowY += this.getRowHeight(rowId);\n    }\n    return rowId;\n  }\n\n\n  findCellByXY(x: number, y: number) {\n    let colId = this.findColumnIdByX(x);\n    let rowId = this.findRowIdByY(y);\n    return this.getCell(colId, rowId);\n  }\n\n\n  public selectByXY(x1: number, y1: number, x2: number, y2: number): any {\n    let top = Math.min(y1, y2);\n    let left = Math.min(x1, x2);\n    let right = Math.max(x1, x2);\n    let bottom = Math.max(y1, y2);\n\n    let stop = this.findRowIdByY(top);\n    let sbottom = this.findRowIdByY(bottom);\n    let sleft = this.findColumnIdByX(left);\n    let sright = this.findColumnIdByX(right);\n    let rowId = this.findRowIdByY(y1);\n    let columnId = this.findColumnIdByX(x1);\n    let selectedCell = this.getCell(columnId, rowId);\n    if (selectedCell && selectedCell.reference && selectedCell.isMerged) {\n      rowId = selectedCell.reference.rowId;\n      columnId = selectedCell.reference.columnId;\n    }\n\n    let ftop = stop;\n    let fbottom = sbottom + 1;\n    let fleft = sleft;\n    let fright = sright + 1;\n\n    for (let x = sleft; x <= sright; x++) {\n      for (let y = stop; y <= sbottom; y++) {\n        let cell = this.getCell(x, y);\n        if (cell) {\n          ftop = Math.min(ftop, cell.top)\n          fleft = Math.min(fleft, cell.left)\n          fbottom = Math.max(fbottom, cell.bottom)\n          fright = Math.max(fright, cell.right)\n        }\n      }\n    }\n\n    this.selection.top = ftop;\n    this.selection.left = fleft;\n    this.selection.right = fright - 1;\n    this.selection.bottom = fbottom - 1;\n    this.selection.rowId = rowId;\n    this.selection.columnId = columnId;\n    this.onChange();\n  }\n\n  public scrollDown(): any {\n    this.scroll(this.scrollColumn, this.scrollRow + 1);\n  }\n\n  public scrollUp(): any {\n    this.scroll(this.scrollColumn, this.scrollRow - 1);\n  }\n\n  public scrollLeft(): any {\n    this.scroll(this.scrollColumn + 1, this.scrollRow);\n  }\n\n  public scrollRight(): any {\n    this.scroll(this.scrollColumn - 1, this.scrollRow);\n  }\n\n  public getCellHeight(cell: Cell): number {\n    let height = 0;\n    for (let i = cell.rowId; i < cell.rowId + cell.rowSpan; i++) {\n      height += this.getRowHeight(i);\n    }\n    return height;\n  }\n\n  public getCellWidth(cell: Cell): number {\n    let width = 0;\n    for (let i = cell.columnId; i < cell.columnId + cell.colSpan; i++) {\n      width += this.getColumnWidth(i);\n    }\n    return width;\n  }\n\n  public scroll(columnId: number, rowId: number) {\n    if (columnId < 0) return;\n    if (rowId < 0) return;\n    for (let x in this.data) {\n      for (let y in this.data[x]) {\n        let cell: Cell = this.data[x][y];\n        if (cell.columnId < parseInt(x)) {\n          columnId = cell.columnId + cell.colSpan;\n        }\n        if (cell.rowId < parseInt(y)) {\n          rowId = cell.rowId + cell.rowSpan;\n        }\n      }\n    }\n\n    this.scrollX = columnId;\n    this.scrollY = rowId;\n\n    this.onChange();\n  }\n\n  public merge(columnId: number, rowId: number, width: number, height: number) {\n    let cell = this.forceGetCell(columnId, rowId);\n    cell.colSpan = width;\n    cell.rowSpan = height;\n    this.setCell(columnId, rowId, cell);\n\n    for (let x = columnId; x < columnId + width; x++) {\n      for (let y = rowId; y < rowId + height; y++) {\n        if (y != rowId || x != columnId) {\n          let xcell = this.forceGetCell(x, y);\n          xcell.reference = cell;\n          this.setCell(x, y, xcell);\n        }\n      }\n    }\n\n    this.onChange();\n  }\n\n  public unmerge(columnId: number, rowId: number) {\n    let cell = this.getCell(columnId, rowId);\n    if (!cell || (cell.rowSpan == 1 && cell.colSpan == 1)) return;\n\n    for (let i = 0; i < cell.colSpan; i++) {\n      for (let j = 0; j < cell.rowSpan; j++) {\n        let cx = this.getCell(i + columnId, j + rowId);\n        if (!cx) continue;\n        cx.reference = null;\n        this.setCell(i + columnId, j + rowId, cx, true);\n      }\n    }\n\n    cell.rowSpan = 1;\n    cell.colSpan = 1;\n    this.setCell(columnId, rowId, cell, true);\n    this.onChange();\n\n  }\n\n  public get scrollColumn() {\n    return this.scrollX;\n  }\n\n  public get scrollRow() {\n    return this.scrollY;\n  }\n\n  public forceGetCell(columnId: number, rowId: number) {\n    let cell = this.getCell(columnId, rowId);\n    if (!cell) {\n      cell = new Cell(columnId, rowId);\n      this.setCell(columnId, rowId, cell);\n    }\n\n    return cell;\n  }\n\n  public getCell(columnId: number, rowId: number): Cell | null {\n    if (!this.data[columnId] || !this.data[columnId][rowId]) {\n      return null;\n    }\n\n    return this.data[columnId][rowId];\n  }\n\n  public setCell(columnId: number, rowId: number, cell: Cell, silent = false) {\n    if (!this.data[columnId]) {\n      this.data[columnId] = []\n    }\n\n    this.data[columnId][rowId] = cell;\n    if (!silent) this.onChange();\n  }\n\n\n  public getColumnAppearance(columnId: number): Appearance {\n    return this.columnAppearance[columnId];\n  }\n\n  public getRowAppearance(rowId: number): Appearance {\n    return this.rowAppearance[rowId];\n  }\n\n  public getCellAppearance(columnId: number, rowId: number): Appearance | null {\n    if (!this.appearance[columnId] || !this.appearance[columnId][rowId]) {\n      return null;\n    }\n\n    return this.appearance[columnId][rowId];\n  }\n\n  public setCellAppearance(columnId: number, rowId: number, appearance: Appearance, silent = false) {\n    if (!this.appearance[columnId]) {\n      this.appearance[columnId] = [];\n    }\n\n    this.appearance[columnId][rowId] = appearance;\n    if (!silent) this.onChange();\n  }\n\n  public setColumAppearance(columnId: number, Appearance: Appearance) {\n    this.columnAppearance[columnId] = Appearance;\n    this.onChange();\n  }\n\n  public setRowAppearance(rowId: number, Appearance: Appearance) {\n    this.rowAppearance[rowId] = Appearance;\n    this.onChange();\n  }\n\n  public getRowHeight(rowId: number): number {\n    return this.rowHeight[rowId] || this.defaultRowHeight;\n  }\n\n  public setRowHeight(row: number, height: number) {\n    this.rowHeight[row] = height;\n    this.onChange();\n  }\n\n  public getColumnWidth(columnId: number): number {\n    return this.columnWidth[columnId] || this.defaultColumnWidth;\n  }\n\n  public setColumnWidth(column: number, width: number): any {\n    this.columnWidth[column] = width;\n    this.onChange();\n  }\n\n  public getAppearance(columnId: number, rowId: number): Appearance {\n    let appearance = new Appearance();\n\n    let cell = this.getCellAppearance(columnId, rowId);\n    let col = this.getColumnAppearance(columnId);\n    let row = this.getRowAppearance(rowId);\n    let def = this.defaultAppearance;\n\n    appearance.background = (cell && cell.background) || (col && col.background) || (row && row.background) || def.background;\n    appearance.fontName = (cell && cell.fontName) || (col && col.fontName) || (row && row.fontName) || def.fontName;\n    appearance.fontSize = (cell && cell.fontSize) || (col && col.fontSize) || (row && row.fontSize) || def.fontSize;\n    appearance.horizontalBorder = (cell && cell.horizontalBorder) || (col && col.horizontalBorder) || (row && row.horizontalBorder) || def.horizontalBorder;\n    appearance.verticalBorder = (cell && cell.verticalBorder) || (col && col.verticalBorder) || (row && row.verticalBorder) || def.verticalBorder;\n    appearance.text = (cell && cell.text) || (col && col.text) || (row && row.text) || def.text;\n    appearance.textAlign = (cell && cell.textAlign) || (col && col.textAlign) || (row && row.textAlign) || def.textAlign;\n    appearance.textStyle = (cell && cell.textStyle) || (col && col.textStyle) || (row && row.textStyle) || def.textStyle;\n\n    return appearance;\n\n  }\n\n  public static get_columnName(column: number) {\n    let az = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    let columnString = \"\";\n    let columnNumber = column + 1;\n    while (columnNumber > 0) {\n      let currentLetterNumber = (columnNumber - 1) % 26;\n      let currentLetter = az[currentLetterNumber];\n      columnString = currentLetter + columnString;\n      columnNumber = (columnNumber - (currentLetterNumber + 1)) / 26;\n    }\n    return columnString;\n  }\n\n  private onChange() {\n    this.change_listeners.forEach(m => m());\n  }\n\n  public addOnChange(handler: () => void) {\n    this.change_listeners.push(handler);\n  }\n\n  public removeOnChange(handler: () => void) {\n    let ix = this.change_listeners.indexOf(handler);\n    if (ix >= 0) {\n      this.change_listeners.splice(ix, 1);\n    }\n  }\n\n  public getWidth(measure: (text: string) => number) {\n    return SheetTitleWidth;\n    //return Math.max(SheetTitleWidth, measure(this.title) + 10); TODO: use this\n  }\n\n  save() {\n    return {\n      title: this.title,\n      data: this.data,\n      appearance: this.appearance,\n      columnAppearance: this.columnAppearance,\n      rowAppearance: this.rowAppearance,\n      rowHeight: this.rowHeight,\n      columnWidth: this.columnWidth,\n      scrollX: this.scrollX,\n      scrollY: this.scrollY,\n      selection: this.selection\n    }\n  }\n\n  private fill(data: any) {\n    this.data = [];\n    for (let d of data) {\n      if (!d) continue;\n      for (let c of d) {\n        if (!c) continue;\n        let cell = Cell.from(c);\n        this.setCell(cell.columnId, cell.rowId, cell, true);\n      }\n    }\n  }\n\n  private style(app: any) {\n    this.appearance = [];\n    if (!app) return;\n    for (let d of app) {\n      if (!d) continue;\n      for (let c of d) {\n        if (!c) continue;\n        let a = Appearance.from(c);\n        const col = app.indexOf(d);\n        const row = d.indexOf(c);\n        this.setCellAppearance(col, row, a, true);\n      }\n    }\n  }\n\n  static load(sheet: any): Sheet {\n    let sh = new Sheet(sheet.title);\n    sh.fill(sheet.data);\n    sh.style(sheet.appearance);\n    sh.columnAppearance = sheet.columnAppearance;\n    sh.rowAppearance = sheet.rowAppearance;\n    sh.columnWidth = sheet.columnWidth;\n    sh.rowHeight = sheet.rowHeight;\n    sh.scrollX = sheet.scrollX;\n    sh.scrollY = sheet.scrollY;\n    sh.selection = sheet.selection;\n\n    return sh;\n  }\n}\n","export function clone(obj: any) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function isComma(ch: string) {\n  return (ch === \",\");\n}\n\nexport function isDigit(ch: string) {\n  return /\\d/.test(ch);\n}\n\nexport function isLetter(ch: string) {\n  return /[a-z]/i.test(ch);\n}\n\nexport function isOperator(ch: string) {\n  return /\\+|-|\\*|\\/|\\^/.test(ch);\n}\n\nexport function isLeftParenthesis(ch: string) {\n  return (ch === \"(\");\n}\n\nexport function isRightParenthesis(ch: string) {\n  return (ch == \")\");\n}\n","import { OpenDocument } from \"./Document\";\nimport { CommandHistory } from \"./CommandHistory\";\nimport { Sheet } from \"./Sheet\";\nimport { clone } from \"../common/utils\";\nimport { Color } from \"../common/types\";\nimport { Appearance, TextAlign } from \"./Appearance\";\n\nexport class Commander {\n  private history: CommandHistory[] = [];\n  private commands: any = {};\n\n  public constructor(private doc: OpenDocument) {\n    this.commands['bold'] = () => this.appearance(app => app.bold = !app.bold);\n    this.commands['italic'] = () => this.appearance(app => app.italic = !app.italic);\n    this.commands['underline'] = () => this.appearance(app => app.underline = !app.underline);\n    this.commands['font-size'] = (size: number) => this.appearance(app => app.fontSize = size);\n    this.commands['font-name'] = (font: string) => this.appearance(app => app.fontName = font);\n    this.commands['bg-color'] = (color: Color) => this.appearance(app => app.background = color);\n    this.commands['fg-color'] = (color: Color) => this.appearance(app => app.text = color);\n    this.commands['top-border'] = (color: Color) => this.topBorder(color);\n    this.commands['no-border'] = () => this.noBorder();\n    this.commands['left-border'] = (color: Color) => this.leftBorder(color);\n    this.commands['right-border'] = (color: Color) => this.rightBorder(color);\n    this.commands['bottom-border'] = (color: Color) => this.bottomBorder(color);\n    this.commands['outside-border'] = (color: Color) => this.outsideBorder(color);\n    this.commands['horizontal-border'] = (color: Color) => this.horizontalBorder(color);\n    this.commands['vertical-border'] = (color: Color) => this.verticalBorder(color);\n    this.commands['cross-border'] = (color: Color) => this.crossBorder(color);\n    this.commands['full-border'] = (color: Color) => {\n      this.topBorder(color, false);\n      this.leftBorder(color, false)\n      this.bottomBorder(color, false)\n      this.rightBorder(color, false)\n      this.appearance(app => {\n        app.setVertical(color);\n        app.setHorizontal(color);\n      });\n    };\n    this.commands['merge'] = () => this.merge();\n    this.commands['unmerge'] = () => this.unmerge();\n    this.commands['align'] = (value: any) => this.appearance(app => app.alignTextTo(value));\n    this.commands['change-value'] = (columnId: number, rowId: number, value: string) => this.changeValue(columnId, rowId, value);\n    this.commands['alter-column'] = (columnId: number, delta: number) => this.alterColumn(columnId, delta);\n    this.commands['alter-row'] = (rowId: number, delta: number) => this.alterRow(rowId, delta);\n  }\n\n  private has(commandName: string) {\n    return !!this.commands[commandName];\n  }\n\n  do(commandName: string, ...args: any[]) {\n    if (!this.has(commandName)) {\n      console.warn(`command ${commandName} does not exsits!`);\n    }\n\n    this.commands[commandName](...args);\n  }\n\n  private get ActiveSheet(): Sheet {\n    return this.doc.ActiveSheet;\n  }\n\n  private get Selection() {\n    return this.ActiveSheet.selection;\n  }\n\n  private outsideBorder(color: Color) {\n    this.logAppearanceOnlyCommand();\n    this.topBorder(color, false);\n    this.rightBorder(color, false);\n    this.bottomBorder(color, false);\n    this.leftBorder(color, false);\n  }\n\n  private horizontalBorder(color: Color) {\n    this.crossBorder(color, true, false);\n  }\n\n  private verticalBorder(color: Color) {\n    this.crossBorder(color, false, true);\n  }\n\n  private crossBorder(color: Color, horizontal = true, vertical = true) {\n    this.logAppearanceOnlyCommand();\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    for (let c = sel.left; c <= sel.right; c++) {\n      for (let r = sel.top; r <= sel.bottom; r++) {\n        let app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n        if (horizontal && r < sel.bottom) app.setHorizontal(color);\n        if (vertical && c < sel.right) app.setVertical(color);\n        this.ActiveSheet.setCellAppearance(c, r, app, false);\n      }\n    }\n  }\n\n  private noBorder() {\n    this.logAppearanceOnlyCommand()\n    this.topBorder(null, false);\n    this.leftBorder(null, false)\n    this.appearance(app => {\n      app.setVertical(null);\n      app.setHorizontal(null);\n    });\n  }\n\n  private topBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    let r = sel.top - 1;\n    for (let c = sel.left; c <= sel.right; c++) {\n      let app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setHorizontal(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private leftBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    let c = sel.left - 1;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      let app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setVertical(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private rightBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    let c = sel.right;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      let app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setVertical(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private bottomBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    for (let c = sel.left; c <= sel.right; c++) {\n      let app = sheet.getCellAppearance(c, sel.bottom) || new Appearance();\n      app.setHorizontal(color);\n      sheet.setCellAppearance(c, sel.bottom, app, false);\n    }\n  }\n\n  private get SelectedAppearance(): Appearance [] {\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    let apps = [];\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      for (let c = sel.left; c <= sel.right; c++) {\n        let app = sheet.getCellAppearance(sel.columnId, sel.rowId);\n        if (app) {\n          apps.push(clone(app));\n        }\n      }\n    }\n    return apps;\n  }\n\n  private get SelectionData() {\n    let sel = this.Selection;\n    let sheet = this.doc.ActiveSheet;\n    let data = [];\n\n    for (let c = sel.left; c <= sel.right; c++) {\n      for (let r = sel.top; r <= sel.bottom; r++) {\n        let cell = sheet.getCell(c, r);\n        data.push(clone(cell));\n      }\n    }\n\n    return data;\n  }\n\n  private logAppearanceOnlyCommand() {\n    let sel = this.Selection;\n    let historyItem: CommandHistory = {\n      selection: sel,\n      appearance: this.SelectedAppearance\n    };\n\n    this.history.push(historyItem);\n  }\n\n  private logDataOnlyCommand() {\n    let sel = this.Selection;\n    let historyItem: CommandHistory = {\n      selection: sel,\n      data: this.SelectionData\n    };\n\n    this.history.push(historyItem);\n  }\n\n  private alterColumn(column: number, delta: number) {\n    const w = this.doc.ActiveSheet.getColumnWidth(column);\n    this.history.push({\n      selection: column,\n      data: w,\n      meta: 'COLUMN'\n    });\n\n    this.doc.ActiveSheet.setColumnWidth(column, w + delta);\n  }\n\n  private alterRow(row: number, delta: number) {\n    const h = this.doc.ActiveSheet.getRowHeight(row);\n    this.history.push({\n      selection: row,\n      data: h,\n      meta: 'ROW'\n    });\n\n    this.doc.ActiveSheet.setRowHeight(row, h + delta);\n  }\n\n  private changeValue(columnId: number, rowId: number, value: string) {\n    this.logDataOnlyCommand();\n    if (columnId == null) columnId = this.Selection.columnId;\n    if (rowId == null) rowId = this.Selection.rowId;\n    this.ActiveSheet.setCellValue(columnId, rowId, value);\n  }\n\n  private merge() {\n    this.logDataOnlyCommand();\n    let sel = this.Selection;\n    let c = Math.min(sel.right, sel.left);\n    let r = Math.min(sel.top, sel.bottom);\n    let w = Math.abs(sel.right - sel.left) + 1;\n    let h = Math.abs(sel.top - sel.bottom) + 1;\n    this.ActiveSheet.merge(c, r, w, h);\n  }\n\n  private unmerge() {\n    this.logDataOnlyCommand();\n    let sel = this.Selection;\n    this.ActiveSheet.unmerge(sel.columnId, sel.rowId);\n  }\n\n  private appearance(method: (app: Appearance) => void): void {\n    this.logAppearanceOnlyCommand();\n    let sel = this.Selection;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      for (let c = sel.left; c <= sel.right; c++) {\n        let app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n        method(app);\n        this.ActiveSheet.setCellAppearance(c, r, app);\n      }\n    }\n  }\n\n  public undo() {\n    throw 'undo has not been implemented';\n  }\n\n  public redo() {\n    throw 'redo has not been implemented'\n  }\n\n}\n","import { TextAlign } from \"../../core/Appearance\";\n\n/**\n * Created by SiamandM on 6/16/2016.\n */\n\nexport enum LayoutDirection {\n  LeftToRight = 1,\n  RightToLeft = 2\n}\n\nexport class Point {\n\n  constructor(x: number = 0, y: number = 0) {\n    this.x = x;\n    this.y = y;\n  }\n\n  x: number;\n  y: number;\n}\n\nexport class ContextMask {\n\n  private x: number = 0;\n  private y: number = 0;\n  private width: number = 0;\n  private height: number = 0;\n\n  constructor(left: number, top: number, width: number, height: number) {\n    this.x = left;\n    this.y = top;\n    this.width = width;\n    this.height = height;\n  }\n\n\n  public get_left() {\n    return this.x;\n  }\n\n  public set_left(value: number) {\n    this.x = value;\n  }\n\n  public get_top() {\n    return this.y;\n  }\n\n  public get_right() {\n    return this.x + this.width;\n  }\n\n  public get_bottom() {\n    return this.y + this.height;\n  }\n\n  public set_top(value: number) {\n    this.y = value;\n  }\n\n  public get_width() {\n    return this.width;\n  }\n\n  public set_width(value: number) {\n    this.width = value;\n  }\n\n  public get_height() {\n    return this.height;\n  }\n\n  public set_height(value: number) {\n    this.height = value;\n  }\n\n  public set_value(x: number, y: number, w: number, h: number) {\n    this.x = x;\n    this.y = y;\n    this.width = w;\n    this.height = h;\n  }\n\n  public get_combinedMask(x: number, y: number, w: number, h: number) {\n    let x2 = Math.min(x + w, this.get_right());\n    let y2 = Math.min(y + h, this.get_bottom());\n\n    w = Math.min(x2 - x, this.get_width());\n    h = Math.min(y2 - y, this.get_height());\n\n    x = Math.max(x, this.get_left());\n    y = Math.max(y, this.get_top());\n\n    return new ContextMask(x, y, w, h);\n  }\n\n}\n\nexport class Context {\n\n  private context2d: CanvasRenderingContext2D;\n  private width: number;\n  private height: number;\n  private currentMask!: ContextMask | null;\n  private maskStack: ContextMask[] = [];\n\n  public direction: LayoutDirection = LayoutDirection.LeftToRight;\n  public textAlign: TextAlign = TextAlign.Left;\n  public fillStyle: any = '#fff';\n  public strokeStyle = '#000';\n  public strokeSize = 1;\n  public contentFillStyle = '#000';\n  public fontStyle = \"\";\n  public fontSize = 12;\n  public fontName = \"Tahoma\";\n\n  constructor(context: CanvasRenderingContext2D, width: number, height: number) {\n    this.context2d = context;\n    this.width = width;\n    this.height = height;\n  }\n\n\n  private applyFill() {\n    this.context2d.fillStyle = this.fillStyle;\n  }\n\n  private applyStroke() {\n    this.context2d.strokeStyle = this.strokeStyle;\n    this.context2d.lineWidth = this.strokeSize;\n  }\n\n  private applyContent() {\n    const style = this.fontStyle.replace('underline', '');\n    this.context2d.fillStyle = this.contentFillStyle;\n    this.context2d.font = (`${this.fontStyle} ${this.fontSize}px ${this.fontName}`).trim();\n    this.context2d.textAlign = 'left';\n  }\n\n  get_directed_x(x: number, width: number = 0) {\n    if (this.direction == LayoutDirection.LeftToRight)\n      return x;\n    return this.width - x - width;\n  }\n\n  get_textWidth(text: string) {\n    return this.context2d.measureText(text).width;\n  }\n\n  save() {\n    this.context2d.save();\n    this.context2d.translate(-0.5, -0.5);\n    if (this.currentMask) {\n      let cmask = this.currentMask;\n\n      this.context2d.rect(cmask.get_left(), cmask.get_top(), cmask.get_width(), cmask.get_height());\n      this.context2d.clip();\n    }\n\n  }\n\n  restore() {\n    this.context2d.restore();\n  }\n\n  setMask(x: number, y: number, w: number, h: number, affectPreviousMask: boolean = false) {\n    x = this.get_directed_x(x, w);\n\n    if (this.currentMask) {\n      this.maskStack.push(this.currentMask);\n    }\n    if (affectPreviousMask && this.currentMask) {\n      this.currentMask = this.currentMask.get_combinedMask(x, y, w, h);\n    } else {\n      this.currentMask = new ContextMask(x, y, w, h);\n    }\n  }\n\n  unmask() {\n    if (this.maskStack.length > 0) {\n      this.currentMask = <ContextMask>this.maskStack.pop();\n    } else {\n      this.currentMask = null;\n    }\n  }\n\n  clearRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.context2d.clearRect(x, y, w, h);\n    this.restore();\n  }\n\n  fillRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.applyFill();\n    this.context2d.beginPath();\n    this.context2d.fillRect(x, y, w, h);\n    this.context2d.fill();\n    this.restore();\n  }\n\n  strokeRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.applyStroke();\n    this.context2d.beginPath();\n    this.context2d.strokeRect(x, y, w, h);\n    this.context2d.stroke();\n    this.restore();\n  }\n\n  line(x1: number, y1: number, x2: number, y2: number) {\n    x1 = this.get_directed_x(x1);\n    x2 = this.get_directed_x(x2);\n\n    this.save();\n    this.applyStroke();\n    this.context2d.beginPath();\n    this.context2d.moveTo(x1, y1);\n    this.context2d.lineTo(x2, y2);\n    this.context2d.stroke();\n    this.restore();\n  }\n\n  private internalPath(close: boolean, stroke: boolean, fill: boolean, points: Point[]) {\n    let args: any = [close, stroke, fill];\n    for (let i = 0; i < points.length; i++)\n      args.push(points[i]);\n    this.path.apply(this, args);\n  }\n\n  path(close: boolean, stroke: boolean, fill: boolean, ...points: Point[]) {\n    this.save();\n    this.applyStroke();\n    this.applyFill();\n    this.context2d.beginPath();\n    let point = points[0];\n    let drpx = this.get_directed_x(point.x);\n    this.context2d.moveTo(drpx, point.y);\n    for (let i = 1; i < points.length; i++) {\n      point = points[i];\n      let drx = this.get_directed_x(point.x);\n      this.context2d.lineTo(drx, point.y);\n    }\n    if (close) {\n      this.context2d.closePath();\n    }\n    if (fill) {\n      this.context2d.fill();\n    }\n    if (stroke) {\n      this.context2d.stroke();\n    }\n\n    this.restore();\n  }\n\n  openPath(...points: Point[]) {\n    this.internalPath(false, true, false, points);\n  }\n\n  closePath(...points: Point[]) {\n    this.internalPath(true, true, false, points);\n  }\n\n  fillOpenPath(...points: Point[]) {\n    this.internalPath(false, true, true, points);\n  }\n\n  fillClosePath(...points: Point[]) {\n    this.internalPath(true, false, true, points);\n  }\n\n  rect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.fillRect(x, y, w, h);\n    this.strokeRect(x, y, w, h);\n  }\n\n  fillText(text: string, x: number, y: number, width: number) {\n    x = this.get_directed_x(x, width);\n    this.save();\n    this.applyContent();\n    let delta = 0;\n    let textWidth = this.get_textWidth(text);\n    if (this.textAlign == TextAlign.Center) {\n      delta = (width - textWidth) / 2;\n    } else if (this.textAlign == TextAlign.Right) {\n      delta = width - textWidth - 10;//TODO: fix that constant value [indent]\n    }\n    if (this.fontStyle && this.fontStyle.indexOf('underline') != -1) {\n      this.rect(x, y + this.fontSize + 2, this.context2d.measureText(text).width, 0);\n    }\n\n    this.context2d.fillText(text, x + delta, y + this.fontSize);\n    this.restore();\n  }\n\n  createGradient(x: number, y: number, w: number, h: number, ...stops: any[]) {\n    let grd = this.context2d.createLinearGradient(x, y, x + w, y + h);\n    for (let n of stops) {\n      grd.addColorStop(n[0], n[1]);\n    }\n    return grd;\n  }\n}\n","import { Sheet } from './Sheet';\nimport { Commander } from './Commander';\n\nexport class OpenDocument {\n\n  private sheets: Sheet[] = [];\n  private activeSheetIndex = 0;\n  private commander: Commander;\n  private change_listeners: (() => void)[] = [];\n\n  public constructor() {\n    this.init();\n    this.commander = new Commander(this);\n  }\n\n  private init() {\n    this.addSheet(\"Sheet1\");\n    this.addSheet(\"Sheet2\");\n    this.addSheet(\"Sheet3\");\n  }\n\n  public addSheet(name: string) {\n    let sheet = new Sheet(name);\n    sheet.addOnChange(() => this.onChange());\n    this.sheets.push(sheet);\n    this.onChange();\n  }\n\n  public get ActiveSheet() {\n    return this.sheets[this.activeSheetIndex];\n  }\n\n  public get ActiveSheetIndex() {\n    return this.activeSheetIndex;\n  }\n\n  public set ActiveSheetIndex(index: number) {\n    if (index < 0 || index >= this.sheets.length) {\n      throw 'invalid sheet index';\n    }\n\n    this.activeSheetIndex = index;\n    this.onChange();\n  }\n\n  public get Sheets(): Sheet[] {\n    return this.sheets;\n  }\n\n  public addOnChange(handler: () => void) {\n    this.change_listeners.push(handler);\n  }\n\n  public removeOnChange(handler: () => void) {\n    let ix = this.change_listeners.indexOf(handler);\n    if (ix >= 0) {\n      this.change_listeners.splice(ix, 1);\n    }\n  }\n\n  public onChange() {\n    this.change_listeners.forEach(m => m());\n  }\n\n  public execCommand(cmd: string, ...args: any[]) {\n    this.commander.do(cmd, ...args);\n  }\n\n  save() {\n    return {\n      sheets: this.sheets.map(sh => sh.save()),\n      activeSheetIndex: this.activeSheetIndex\n    }\n  }\n\n  load(obj: any) {\n    this.sheets = obj.sheets.map((sh: any) => Sheet.load(sh));\n    this.activeSheetIndex = obj.activeSheetIndex;\n    this.onChange();\n  }\n}\n","import {\n  RowDefaultHeight,\n  ColumnHeaderHeight,\n  RowHeaderWidth,\n  SheetTitleHeight,\n  COLOR_3,\n  COLOR_1,\n  COLOR_LIGHT,\n  COLOR_CREAM\n} from '../../common/constants'\nimport { DocumentRenderer } from \"../DocumentRenderer\";\nimport { OpenDocument } from \"../../core/Document\";\nimport { Context, Point } from './Context';\nimport { TextAlign } from \"../../core/Appearance\";\nimport { Sheet } from \"../../core/Sheet\";\n\n\nexport class CanvasRenderer implements DocumentRenderer {\n  private canvas!: HTMLCanvasElement;\n  private rendering: boolean = false;\n  private renderFrameRate: number = 10;//FPS\n  private context!: Context;\n\n  public width!: number;\n  public height!: number;\n\n\n  public constructor(private container: HTMLElement, private document: OpenDocument) {\n    this.initialize();\n    document.addOnChange(() => this.render());\n  }\n\n  initialize() {\n    this.createElements();\n    this.resize();\n    this.render();\n  }\n\n  public get Element(): HTMLElement {\n    return this.container;\n  }\n\n  createElements() {\n    this.canvas = document.createElement(\"canvas\");\n    this.container.appendChild(this.canvas);\n  }\n\n  resize() {\n    let pixelRatio = window.devicePixelRatio;\n    this.width = this.container.clientWidth;\n    this.height = this.container.clientHeight;\n    if (pixelRatio > 1) {\n      this.canvas.width = this.width * pixelRatio;\n      this.canvas.height = this.height * pixelRatio;\n      this.canvas.style.width = this.width + 'px';\n      this.canvas.style.height = this.height + 'px';\n    } else {\n      this.canvas.width = this.width;\n      this.canvas.height = this.height;\n    }\n    this.render();\n  }\n\n  get_context2D() {\n    let pixelRatio = window.devicePixelRatio;\n    this.canvas.width = this.canvas.width;\n    let context = <CanvasRenderingContext2D>this.canvas.getContext('2d');\n    context.scale(pixelRatio, pixelRatio);\n    return context;\n  }\n\n  render() {\n    if (this.rendering) {\n      return;\n    }\n\n    this.rendering = true;\n    setTimeout(() => {\n      this.doRender();\n      this.rendering = false;\n    }, 1000 / this.renderFrameRate);\n\n  }\n\n  doRender() {\n    console.log('%cRender', `color:${COLOR_1}`);\n    let context2d = this.get_context2D();\n    this.context = new Context(context2d, this.width, this.height);\n    this.renderSheetTitles();\n    this.renderSheet();\n  }\n\n  private renderTopCorner() {\n    this.context.fillStyle = '#ececec';\n    this.context.fontSize = 12;\n    const cornerWidth = RowHeaderWidth - 2;\n    this.context.fillClosePath(new Point(2, cornerWidth), new Point(cornerWidth, cornerWidth), new Point(cornerWidth, 1));\n\n  }\n\n  private renderSheetTitles() {\n    this.renderTopCorner();\n\n    this.context.strokeSize = 1;\n    let x1 = 0;\n    let y1 = this.height - SheetTitleHeight - .5;\n    let rHeight = SheetTitleHeight + 5;\n    let h = this.height - SheetTitleHeight - 0.5;\n    this.context.rect(x1, y1, this.width, rHeight);\n    this.context.fillStyle = this.context.createGradient(0, h, 0, SheetTitleHeight / 3, [0, '#f0f0f0'], [1, '#fff']);\n    this.context.fillRect(x1, y1, this.width, rHeight);\n    this.context.textAlign = TextAlign.Center;\n\n    let x = RowHeaderWidth;\n    let active = this.document.ActiveSheet;\n    const delta = 5;\n    for (let sh of this.document.Sheets) {\n      let sheetWidth = sh.getWidth(str => this.context.get_textWidth(str));\n      this.context.strokeStyle = '#aaa';\n      this.context.fillStyle = '#fafafa';\n      this.context.fontStyle = 'italic';\n      if (sh === active) {\n        this.context.fillStyle = '#fff';\n        this.context.fontStyle = 'bold';\n      }\n      this.context.rect(x, h, sheetWidth, SheetTitleHeight - delta);\n      this.context.fillText(sh.title, x, h + delta, sheetWidth)\n      if (sh === active) {\n        this.context.fillStyle = COLOR_3;\n        this.context.fillRect(x, h + SheetTitleHeight - delta, sheetWidth, 2);\n        this.context.strokeStyle = COLOR_LIGHT;\n      }\n      this.context.line(x, h, x + sheetWidth, h);\n\n      x += sheetWidth + delta;\n    }\n    this.context.fontStyle = '';\n  }\n\n  private renderSheet() {\n    let width = this.width;\n    let height = this.height;\n\n    let sheetTitleHeight = SheetTitleHeight;\n    let maskHeight = height - sheetTitleHeight;\n    let context = this.context;\n\n    context.setMask(0, 0, width, height - (sheetTitleHeight + 1.5));\n    let lastRow = this.renderRows();\n    let lastColumn = this.renderColumns();\n    context.unmask();\n\n    context.setMask(ColumnHeaderHeight + .5, RowHeaderWidth, width, maskHeight - RowHeaderWidth - .5);\n    this.renderCells(lastColumn, lastRow);\n    context.unmask();\n  }\n\n  private renderRows() {\n    let context = this.context;\n    let height = this.height - RowHeaderWidth - SheetTitleHeight;\n    let cumulativeHeight = RowDefaultHeight;\n    let sheet = this.document.ActiveSheet;\n\n    let rw = sheet.scrollRow;\n    for (; cumulativeHeight < height; rw++) {\n      let rowHeight = sheet.getRowHeight(rw);\n      this.paintRow(cumulativeHeight, (rw + 1).toString());\n      cumulativeHeight += rowHeight;\n    }\n\n    return rw;\n  }\n\n  private paintRow(top: number, label: string): any {\n    let context = this.context;\n    context.save();\n    context.strokeSize = 1;\n    context.strokeStyle = '#ccc';\n    context.fillStyle = '#fafafa';\n    context.rect(0, top, RowHeaderWidth, this.height);\n    context.fillRect(0, top, RowHeaderWidth, this.height);\n    context.fontSize = 12;\n    context.textAlign = TextAlign.Center;\n    context.fillText(label, 0, top + (RowDefaultHeight - 12) / 2, RowHeaderWidth);\n    context.restore();\n  }\n\n  private renderColumns() {\n    let width = this.width;\n    let sheet = this.document.ActiveSheet;\n    let cumulativeWidth = RowHeaderWidth + .5;\n    let cl = sheet.scrollColumn;\n\n    for (; cumulativeWidth <= width; cl++) {\n      let columnWidth = sheet.getColumnWidth(cl);\n      this.paintColumn(cumulativeWidth, Sheet.get_columnName(cl), columnWidth);\n      cumulativeWidth += columnWidth;\n    }\n    return cl;\n  }\n\n  private paintColumn(left: number, label: string, columnWidth: number) {\n    let context = this.context;\n    context.strokeSize = 1;\n    context.strokeStyle = '#ccc';\n    context.fillStyle = '#fafafa';\n    context.fontName = 'Tahoma';\n    context.fontSize = 12;\n    context.rect(left, 0, this.width, ColumnHeaderHeight - 1);\n    context.fillRect(left, 0, this.width, ColumnHeaderHeight - 1);\n    context.fillText(label, left, 7, columnWidth);\n  }\n\n  private renderCells(lastColumn: number, lastRow: number) {\n    let x: number = 0;\n    let y: number = 0;\n\n    let sheet = this.document.ActiveSheet;\n    let cellsToPaint = [];\n    let context = this.context;\n    context.strokeStyle = '#eee';\n    context.strokeSize = 1;\n    for (let r = sheet.scrollRow - 1; r < lastRow; r++) {\n      let rowHeight = sheet.getRowHeight(r);\n      x = 0;\n      for (let c = sheet.scrollColumn; c <= lastColumn; c++) {\n        let columnWidth = sheet.getColumnWidth(c);\n        let cell = sheet.getCell(c, r);\n        let cellHeight = cell ? sheet.getCellHeight(cell) : sheet.getRowHeight(r);\n        let cellWidth = cell ? sheet.getCellWidth(cell) : sheet.getColumnWidth(c);\n        let appearance = sheet.getAppearance(c, r);\n        context.fillStyle = appearance.text;\n        this.paintCell(c, r, x, y);\n\n        if (y > 0 && (!cell || !cell.isMerged)) {\n          let horStyle = appearance.horizontalBorder;\n          let verStyle = appearance.verticalBorder;\n\n          context.strokeStyle = (horStyle && horStyle.color) || '#eeeeee';\n          if (appearance.background == null || horStyle != null) {\n            context.line(x + RowHeaderWidth, y + cellHeight, x + RowHeaderWidth + cellWidth, y + cellHeight);\n          }\n          context.strokeStyle = (verStyle && verStyle.color) || '#eeeeee';\n          if (appearance.background == null || verStyle != null) {\n            context.line(x + RowHeaderWidth + cellWidth, y, x + RowHeaderWidth + cellWidth, y + cellHeight);\n          }\n        }\n        x += columnWidth;\n      }\n      y += rowHeight;\n    }\n  }\n\n  private paintCell(columnId: number, rowId: number, x: number, y: number) {\n    let context = this.context;\n    let sheet = this.document.ActiveSheet;\n    let cell = sheet.getCell(columnId, rowId);\n    if (cell && cell.isMerged) return;\n\n    let appearance = sheet.getAppearance(columnId, rowId);\n    let left = x + ColumnHeaderHeight;\n    if (y < RowDefaultHeight) return;\n\n    if (appearance.fontSize) context.fontSize = parseInt(appearance.fontSize + '');\n    if (appearance.fontName) context.fontName = appearance.fontName;\n    context.fontStyle = (appearance.textStyle) ? appearance.textStyle : '';\n\n    let cellWidth = cell ? sheet.getCellWidth(cell) : sheet.getColumnWidth(columnId);\n    let cellHeight = cell ? sheet.getCellHeight(cell) : sheet.getRowHeight(rowId);\n\n    context.setMask(left, y, cellWidth, cellHeight);\n    if (appearance.background) {\n      context.fillStyle = appearance.background;\n      context.fillRect(left, y, cellWidth, cellHeight);\n    }\n    if (cell && cell.label) {\n      context.contentFillStyle = appearance.text;\n      context.strokeStyle = appearance.text;\n      context.textAlign = appearance.textAlign;\n      context.fillText(cell.label, x + ColumnHeaderHeight + 5, y + 7, cellWidth);\n    }\n    context.unmask();\n  }\n\n}\n","import { OpenDocument } from \"../core/Document\";\nimport { UIHandlerController } from \"./UIHandlerControler\";\nimport { ColumnHeaderHeight, RowHeaderWidth, SheetTitleHeight, COLOR_1, COLOR_2 } from \"../common/constants\";\nimport { Cell } from \"../core/Cell\";\nimport { Sheet } from \"../core/Sheet\";\nimport { TextAlign } from \"../core/Appearance\";\nimport { CellValue } from \"@/lib/common/types\"\n\n/**\n * Created by SiamandM on 6/23/2016.\n */\n///<reference path=\"UIHandler.ts\"/>\n\nexport class CellEditor {\n\n  private websheet: OpenDocument;\n  private editorArea!: HTMLDivElement;\n  private selectionElement!: HTMLElement;\n  private editorElement!: HTMLInputElement;\n  private anchorElement!: HTMLSpanElement;\n  private editMode = false;\n\n  constructor(public controler: UIHandlerController) {\n    this.websheet = controler.websheet;\n    this.initialize();\n    this.select();\n  }\n\n  initialize() {\n    this.editorArea = document.createElement('div');\n    this.editorArea.style.position = 'absolute';\n    this.editorArea.style.top = ColumnHeaderHeight + 'px';\n    this.editorArea.style.left = RowHeaderWidth + 'px';\n    this.editorArea.style.bottom = SheetTitleHeight + 'px';\n    this.editorArea.style.right = '0px';\n    this.editorArea.style.overflow = 'visible';\n    this.controler.renderer.Element.appendChild(this.editorArea);\n\n    this.selectionElement = document.createElement('div');\n    this.selectionElement.style.position = 'absolute';\n    this.selectionElement.style.border = `solid 2px ${COLOR_1}`;\n    this.selectionElement.style.overflow = 'hidden';\n    this.selectionElement.style.background = 'rgba(0,0,0,.1)';\n    this.selectionElement.style.transitionDuration = '.1s';\n    this.editorArea.appendChild(this.selectionElement);\n\n    this.editorElement = document.createElement('input');\n    this.editorElement.type = 'text';\n    this.editorElement.style.display = 'block';\n    this.editorElement.style.zIndex = '10000';\n    this.editorElement.style.position = 'absolute';\n    this.editorElement.style.background = '#fff';\n    this.editorElement.style.textIndent = '3px';\n    this.editorElement.style.border = 'none';\n    this.selectionElement.appendChild(this.editorElement);\n\n    this.anchorElement = document.createElement('span');\n    this.anchorElement.style.position = 'absolute';\n    this.anchorElement.style.right = '0';\n    this.anchorElement.style.bottom = '0';\n    this.anchorElement.style.width = '6px';\n    this.anchorElement.style.height = '6px';\n    this.anchorElement.style.borderRadius = '2px';\n    this.anchorElement.style.border = 'solid 1px #fff';\n    this.anchorElement.style.background = COLOR_2;\n    this.anchorElement.style.zIndex = '10000';\n    this.anchorElement.style.cursor = 'cell';\n    this.editorArea.appendChild(this.anchorElement);\n\n    this.websheet.addOnChange(() => {\n      const value = this.websheet.ActiveSheet.SelectedValue;\n      if (value != this.Value) {\n        this.Value = value\n      }\n\n      this.updateEditorAppearance();\n      this.select(true);\n    })\n\n  }\n\n  disableAnimation() {\n    this.selectionElement.style.transitionDuration = '';\n    this.anchorElement.style.transitionDuration = '';\n  }\n\n  enableAnimation() {\n    this.selectionElement.style.transitionDuration = '.1s';\n    this.anchorElement.style.transitionDuration = '.1s';\n  }\n\n  public get Value() {\n    if (this.editorElement.value == \"\")\n      return null;\n\n    return this.editorElement.value;\n  }\n\n  public set Value(newValue: CellValue) {\n    if (this.editorElement) {\n      this.editorElement.value = newValue ? newValue + '' : '';\n    }\n  }\n\n  public get IsDirty() {\n    let cell = this.getCurrentCell();\n    return (cell.value != this.Value)\n  }\n\n  public get EditMode() {\n    return this.editMode;\n  }\n\n  public set EditMode(mode: boolean) {\n    this.editMode = mode;\n    if (mode) {\n      this.editorElement.readOnly = false;\n    } else {\n      this.editorElement.readOnly = true;\n    }\n    this.editorElement.focus();\n  }\n\n  public deselect() {\n    let cell = this.getCurrentCell();\n    if (this.IsDirty) {\n      this.controler.websheet.execCommand('change-value', cell.columnId, cell.rowId, this.Value)\n    }\n  }\n\n  private getCurrentCell() {\n    let sheet = this.controler.websheet.ActiveSheet;\n    let selection = sheet.selection;\n    return sheet.getCell(selection.columnId, selection.rowId) || new Cell(selection.columnId, selection.rowId);\n  }\n\n  private getCurrentAppearance() {\n    let sheet = this.controler.websheet.ActiveSheet;\n    let selection = sheet.selection;\n    return sheet.getAppearance(selection.columnId, selection.rowId);\n  }\n\n  private getTextAlign(textAlign: TextAlign) {\n    if (textAlign == TextAlign.Center) return 'center';\n    if (textAlign == TextAlign.Left) return 'left';\n    if (textAlign == TextAlign.Right) return 'right';\n    return '';\n  }\n\n  public updateEditorAppearance() {\n    let app = this.getCurrentAppearance();\n\n    this.editorElement.style.textAlign = this.getTextAlign(app.textAlign);\n    this.editorElement.style.fontStyle = app.italic ? 'italic' : '';\n    this.editorElement.style.fontWeight = app.bold ? 'bold' : '';\n    this.editorElement.style.background = app.background;\n    this.editorElement.style.fontFamily = app.fontName;\n    this.editorElement.style.fontSize = `${app.fontSize}px`;\n    this.editorElement.style.color = app.text;\n    this.editorElement.style.textDecoration = app.underline ? 'underline' : '';\n  }\n\n  public select(animation = true) {\n    if (animation) {\n      this.enableAnimation();\n    } else {\n      this.disableAnimation();\n    }\n\n    this.updateEditorAppearance();\n\n    let sheet = this.controler.websheet.ActiveSheet;\n    let selection = sheet.selection;\n\n    let x1 = sheet.getColumnLeft(selection.left);\n    let y1 = sheet.getRowTop(selection.top);\n    let x2 = sheet.getColumnRight(selection.right);\n    let y2 = sheet.getRowBottom(selection.bottom);\n\n    let w = x2 - x1;\n    let h = y2 - y1;\n\n    this.selectionElement.style.left = (x1 - 2) + 'px';\n    this.selectionElement.style.top = (y1 - 2) + 'px';\n    this.selectionElement.style.width = (w - 2) + 'px';\n    this.selectionElement.style.height = (h - 2) + 'px';\n\n    let selectedCell = this.getCurrentCell();\n\n    let editorY = sheet.getRowTop(selection.rowId);\n    let editorX = sheet.getColumnLeft(selection.columnId);\n\n    this.editorElement.style.left = (editorX - x1) + 'px';\n    this.editorElement.style.top = (editorY - y1) + 'px';\n    this.editorElement.style.width = (sheet.getCellWidth(selectedCell) - 3) + 'px';\n    this.editorElement.style.height = (sheet.getCellHeight(selectedCell) - 3) + 'px';\n\n    this.editorElement.focus();\n\n    this.anchorElement.style.left = `${x2 - 5}px`;\n    this.anchorElement.style.top = `${y2 - 5}px`;\n\n  }\n\n}\n","///<reference path=\"../core/Sheet.ts\"/>\n///<reference path=\"./CellEditor.ts\"/>\n\nimport { Sheet } from \"../core/Sheet\";\nimport { UIHandlerController } from \"./UIHandlerControler\";\n\n//import {CellEditor} from \"./CellEditor\"\n/**\n * Created by SiamandM on 6/17/2016.\n */\n\nexport interface IUIHandler {\n  click(): void\n\n  dblClick(): void\n\n  mouseDown(x: number, y: number): void\n\n  mouseMove(x: number, y: number): void\n\n  mouseUp(x: number, y: number): void\n\n  mouseWheel(dx: number, dy: number): void\n\n  keyDown(evt: any): void\n\n  keyPress(evt: any): void\n\n  keyUp(evt: any): void\n}\n\nexport class UIHandler implements IUIHandler {\n  constructor(protected controller: UIHandlerController) {\n\n  }\n\n  click() {\n  }\n\n  dblClick() {\n  }\n\n  mouseDown(x: number, y: number) {\n  }\n\n  mouseMove(x: number, y: number) {\n  }\n\n  mouseUp(x: number, y: number) {\n  }\n\n  mouseWheel(dx: number, dy: number) {\n  }\n\n  keyDown(evt: KeyboardEvent) {\n  }\n\n\n  keyPress(evt: any) {\n  }\n\n  keyUp(evt: any) {\n  }\n\n  get locked() {\n    return this.controller.locked;\n  }\n\n  lock() {\n    this.controller.lock(this);\n  }\n\n  unlock() {\n    this.controller.unlock();\n  }\n\n}\n","import { UIHandler } from './UIHandler';\nimport { SheetTitleHeight, RowHeaderWidth, SheetTitleWidth } from '../common/constants';\n\nexport class WebSheetUIHandler extends UIHandler {\n\n  mouseUp(x: number, y: number) {\n    if (y < this.controller.renderer.Element.clientHeight - SheetTitleHeight) {\n      return;\n    }\n\n    let j = Math.floor((x - RowHeaderWidth) / (SheetTitleWidth + 5));\n    let n = (x - RowHeaderWidth) % (SheetTitleWidth + 5);\n    if (n < SheetTitleWidth && j < this.controller.websheet.Sheets.length) {\n      this.controller.changeActiveSheet(j);\n    }\n  }\n\n\n}\n","import { UIHandler } from \"./UIHandler\";\nimport { ColumnHeaderHeight, RowHeaderWidth, SheetTitleHeight } from \"../common/constants\";\nimport { UIHandlerController } from \"@/lib/editor/UIHandlerControler\"\nimport { Sheet } from \"@/lib/core/Sheet\"\n\nexport class SheetUIHandler extends UIHandler {\n\n  private wheelDeltaX: number = 0;\n  private wheelDeltaY: number = 0;\n\n  private oldX!: number;\n  private oldY!: number;\n  private sheet: Sheet\n\n  constructor(controller: UIHandlerController) {\n    super(controller);\n    this.sheet = controller.websheet.ActiveSheet;\n  }\n\n  mouseWheel(dx: number, dy: number) {\n\n    this.wheelDeltaX += dx;\n    this.wheelDeltaY += dy;\n\n    let websheet = this.controller.websheet;\n    let sheet = websheet.ActiveSheet;\n    let delta = 120;\n\n    if (this.wheelDeltaX > delta) {\n      sheet.scrollRight();\n      this.wheelDeltaX = 0;\n    } else if (this.wheelDeltaX < -delta) {\n      sheet.scrollLeft();\n      this.wheelDeltaX = 0;\n    }\n\n    if (this.wheelDeltaY > delta) {\n      sheet.scrollUp();\n      this.wheelDeltaY = 0;\n    } else if (this.wheelDeltaY < -delta) {\n      sheet.scrollDown();\n      this.wheelDeltaY = 0;\n    }\n    this.controller.renderer.render();\n    this.controller.select();\n\n  }\n\n  mouseDown(x: number, y: number) {\n    this.oldX = x;\n    this.oldY = y;\n  }\n\n  mouseUp(x: number, y: number) {\n    this.selectCell(x, y);\n  }\n\n  keyPress(evt: KeyboardEvent) {\n    if (evt.key == 'Enter') {\n      if (!this.controller.EditMode) {\n        this.controller.EditMode = true;\n        return;\n      } else {\n        this.controller.commit();\n        this.controller.EditMode = false;\n      }\n      if (evt.shiftKey) {\n        this.sheet.selectPreviousRowCell();\n      } else {\n        this.sheet.selectNextRowCell();\n      }\n    }\n  }\n\n  keyDown(evt: KeyboardEvent) {\n    if (evt.key == 'Tab') {\n      this.controller.deselect();\n      if (evt.shiftKey) {\n        this.sheet.selectPreviousColumnCell();\n      } else {\n        this.sheet.selectNextColumnCell();\n      }\n      evt.preventDefault();\n      this.controller.select(true);\n    }\n    if (this.controller.EditMode) {\n      return;\n    }\n    if (evt.key == 'ArrowRight' || evt.key == 'ArrowLeft' || evt.key == 'ArrowUp' || evt.key == 'ArrowDown') {\n      this.controller.deselect();\n      if (evt.key == 'ArrowRight') {\n        this.sheet.selectNextColumnCell();\n      } else if (evt.key == 'ArrowLeft') {\n        this.sheet.selectPreviousColumnCell();\n      } else if (evt.key == 'ArrowUp') {\n        this.sheet.selectPreviousRowCell();\n      } else if (evt.key == 'ArrowDown') {\n        this.sheet.selectNextRowCell();\n      }\n      evt.preventDefault();\n      this.controller.select(true);\n    }\n  }\n\n  private selectCell(x: number, y: number) {\n    if (y < ColumnHeaderHeight || x < RowHeaderWidth) {\n      return;\n    }\n    if (y > this.controller.renderer.Element.clientHeight - SheetTitleHeight) {\n      return;\n    }\n    let sheet = this.controller.websheet.ActiveSheet;\n    let x1 = this.oldX - RowHeaderWidth;\n    let y1 = this.oldY - ColumnHeaderHeight;\n    let x2 = x - RowHeaderWidth;\n    let y2 = y - ColumnHeaderHeight;\n    this.controller.deselect();\n    sheet.selectByXY(x1, y1, x2, y2);\n    this.controller.select(true);\n  }\n\n}\n","import { UIHandler } from \"./UIHandler\";\nimport { RowHeaderWidth, ColumnHeaderHeight } from \"../common/constants\";\n\nconst delta = 4;\n\nexport class ResizeHandler extends UIHandler {\n\n  private col: any;\n  private row: any;\n  private oldX!: number;\n  private oldY!: number;\n  private engaged = false;\n\n  mouseMove(x: number, y: number) {\n    const c = this.hitColumn(x - RowHeaderWidth, y);\n    const r = this.hitRow(x, y - ColumnHeaderHeight);\n    if (c !== false) {\n      this.controller.changeCursor('col-resize');\n    } else if (r !== false) {\n      this.controller.changeCursor('row-resize');\n    } else if (!this.engaged) {\n      this.controller.resetCursor();\n    }\n  }\n\n  mouseDown(x: number, y: number) {\n    this.col = this.hitColumn(x - RowHeaderWidth, y);\n    this.row = this.hitRow(x, y - ColumnHeaderHeight);\n    this.oldX = x;\n    this.oldY = y;\n    if (this.col !== false || this.row !== false) {\n      this.lock();\n\n      if (this.col !== false) {\n        this.controller.changeCursor('col-resize');\n      } else if (this.row !== false) {\n        this.controller.changeCursor('row-resize');\n      }\n      this.engaged = true;\n    } else {\n      this.engaged = false;\n    }\n  }\n\n  mouseUp(x: number, y: number) {\n    if (!this.engaged) return;\n    if (this.col !== false) {\n      this.controller.alterColumn(this.col, x - this.oldX);\n      this.controller.resetCursor();\n    }\n\n    if (this.row !== false) {\n      this.controller.alterRow(this.row, y - this.oldY);\n      this.controller.resetCursor();\n    }\n\n    this.unlock();\n  }\n\n  private hitRow(x: number, y: number): any {\n    if (x > RowHeaderWidth) return false;\n    const rowH = (r: any) => this.controller.websheet.ActiveSheet.getRowHeight(r);\n    let j = 0;\n    for (let i = rowH(j++); i < y + delta; i += rowH(j++)) {\n      if ((y > (i - delta)) && (y < (i + delta))) {\n        return j - 1;\n      }\n    }\n\n    return false;\n  }\n\n  private hitColumn(x: number, y: number): any {\n    if (y > ColumnHeaderHeight) return false;\n    const colW = (c: any) => this.controller.websheet.ActiveSheet.getColumnWidth(c);\n    let j = 0;\n    for (let i = colW(j++); i < x + delta; i += colW(j++)) {\n      if ((x > (i - delta)) && (x < (i + delta))) {\n        return j - 1;\n      }\n    }\n\n    return false;\n  }\n}\n","import { UIHandler } from \"./UIHandler\";\nimport { CellEditor } from \"./CellEditor\";\nimport { WebSheetUIHandler } from \"./DocumentHandler\";\nimport { SheetUIHandler } from \"./SheetUIHandler\";\nimport { OpenDocument } from \"../core/Document\";\nimport { DocumentRenderer } from \"../rendering/DocumentRenderer\";\nimport { ResizeHandler } from \"./ResizeHandler\";\n\nexport class UIHandlerController {\n\n  private handlers: UIHandler[] = [];\n  private lockedOn: UIHandler | null = null;\n  private cellEditor!: CellEditor;\n\n  constructor(public websheet: OpenDocument, public renderer: DocumentRenderer) {\n    this.cellEditor = new CellEditor(this);\n    this.addHandlers();\n    this.attachEvents();\n    websheet.addOnChange(() => this.cellEditor.updateEditorAppearance());\n  }\n\n  private addHandlers() {\n    this.handlers.push(new WebSheetUIHandler(this));\n    this.handlers.push(new SheetUIHandler(this));\n    this.handlers.push(new ResizeHandler(this));\n  }\n\n  public get EditMode() {\n    return this.cellEditor.EditMode;\n  }\n\n  public set EditMode(mode: boolean) {\n    this.cellEditor.EditMode = mode;\n  }\n\n  public select(animation: boolean = true) {\n    this.cellEditor.select(animation)\n  }\n\n  public deselect() {\n    this.cellEditor.deselect()\n  }\n\n  public alterColumn(columnId: number, delta: number) {\n    this.websheet.execCommand('alter-column', columnId, delta);\n  }\n\n  public alterRow(rowId: number, delta: number) {\n    this.websheet.execCommand('alter-row', rowId, delta);\n  }\n\n  get locked() {\n    return !!this.lockedOn;\n  }\n\n  public lock(uiHandler: UIHandler) {\n    this.lockedOn = uiHandler;\n  }\n\n  public unlock() {\n    this.lockedOn = null;\n  }\n\n  public resetCursor() {\n    this.renderer.Element.style.cursor = '';\n  }\n\n  public changeCursor(cursor: string) {\n    this.renderer.Element.style.cursor = cursor;\n  }\n\n  attachEvents() {\n    let element = this.renderer.Element;\n    let overlay = document.createElement('div');\n    overlay.style.position = 'absolute';\n    overlay.style.top = '0';\n    overlay.style.left = '0';\n    overlay.style.right = '0';\n    overlay.style.bottom = '0';\n    overlay.style.zIndex = '9999';\n    element.appendChild(overlay);\n\n    const controler = this;\n\n    const getXY = function (evt: MouseEvent) {\n      let x = evt.offsetX || evt.layerX || (evt.clientX - element.offsetLeft);\n      let y = evt.offsetY || evt.layerY || (evt.clientY - element.offsetTop);\n\n      return {'x': x, 'y': y}\n    };\n\n    overlay.addEventListener('mousedown', (evt: MouseEvent) => {\n      let pos = getXY(evt);\n      controler.mouseDown(pos.x, pos.y);\n    })\n\n    overlay.addEventListener('mousemove', (evt: MouseEvent) => {\n      let pos = getXY(evt);\n      controler.mouseMove(pos.x, pos.y);\n    })\n\n    overlay.addEventListener('mouseup', (evt: MouseEvent) => {\n      let pos = getXY(evt);\n      controler.mouseUp(pos.x, pos.y);\n    })\n\n    overlay.addEventListener('click', (evt: MouseEvent) => controler.click())\n    overlay.addEventListener('dblclick', (evt: MouseEvent) => controler.dblClick())\n    overlay.addEventListener('mousewheel', (evt: any) => {\n      let dx = evt.wheelDeltaX;\n      let dy = evt.wheelDeltaY;\n      controler.mouseWheel(dx, dy);\n      evt.preventDefault();\n      evt.stopPropagation();\n      return false;\n    })\n\n    window.addEventListener('keydown', (evt: any) => controler.keyDown(evt));\n    window.addEventListener('keypress', (evt: any) => controler.keyPress(evt));\n    window.addEventListener('keyup', (evt: any) => controler.keyUp(evt));\n    window.addEventListener('resize', () => this.renderer.resize());\n\n  }\n\n  click() {\n    if (this.lockedOn) {\n      this.lockedOn.click();\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].click();\n    }\n  }\n\n  dblClick() {\n    if (this.lockedOn) {\n      this.lockedOn.dblClick();\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].dblClick();\n    }\n  }\n\n  mouseDown(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseDown(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseDown(x, y);\n    }\n  }\n\n  mouseMove(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseMove(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseMove(x, y);\n    }\n  }\n\n  mouseUp(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseUp(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseUp(x, y);\n    }\n  }\n\n  mouseWheel(dx: number, dy: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseWheel(dx, dy);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseWheel(dx, dy);\n    }\n  }\n\n  keyDown(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyDown(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyDown(evt);\n    }\n  }\n\n  keyPress(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyPress(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyPress(evt);\n    }\n  }\n\n  keyUp(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyUp(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyUp(evt);\n    }\n  }\n\n  changeActiveSheet(index: number) {\n    this.cellEditor.deselect();\n    this.websheet.ActiveSheetIndex = index;\n    this.cellEditor.select(false);\n  }\n\n  commit() {\n    this.cellEditor.deselect();\n    this.cellEditor.select(false);\n  }\n}\n","import { OpenDocument } from './core/Document';\nimport { DocumentRenderer } from './rendering/DocumentRenderer';\nimport { CanvasRenderer } from './rendering/canvas/CanvasRendering';\nimport { UIHandlerController } from './editor/UIHandlerControler';\n\nexport class UI {\n\n  private handlers: ((doc: OpenDocument) => void)[] = [];\n  private document: OpenDocument = new OpenDocument();\n  private readonly render: DocumentRenderer | null = null;\n  private uiController: UIHandlerController;\n\n  public constructor(private element: HTMLElement) {\n    this.render = new CanvasRenderer(element, this.document);\n    this.uiController = new UIHandlerController(this.document, this.render);\n    this.document.addOnChange(() => this.raiseOnChangeEventListener());\n    this.render.render();\n\n    (<any>element)['openDocument'] = this.document;\n  }\n\n  get isMerged() {\n    let cell = this.selectedCell;\n    if (!cell) return false;\n    return (cell.colSpan > 1) || (cell.rowSpan > 1);\n  }\n\n  public get selectedCell() {\n    return this.document.ActiveSheet.selectedCell;\n  }\n\n  public get SelectedCellLabel() {\n    return this.document.ActiveSheet.SelectionLabel;\n  }\n\n  public get SelectedValue() {\n    return this.document.ActiveSheet.SelectedValue;\n  }\n\n  public get SelectedAppearance() {\n    return this.document.ActiveSheet.SelectedAppearance;\n  }\n\n  public execCmd(cmd: string, ...args: any[]) {\n    console.log(`the command _${cmd}_ executed.`);\n    this.uiController.commit();\n    this.document.execCommand(cmd, ...args);\n  }\n\n  public addOnChangeEventListener(handler: (doc: OpenDocument) => void) {\n    this.handlers.push(handler);\n  }\n\n  public removeOnChangeEventListener(handler: (doc: OpenDocument) => void) {\n    let ix = this.handlers.indexOf(handler);\n    if (ix != -1) {\n      this.handlers.splice(ix, 1);\n    }\n  }\n\n  private raiseOnChangeEventListener() {\n    this.handlers.forEach(handler => handler(this.document));\n  }\n\n  save() {\n    return JSON.stringify(this.document.save());\n  }\n\n  load(data: any) {\n    let obj = JSON.parse(data);\n    this.document.load(obj);\n  }\n}\n","\n\n\n\n\nimport { Component } from \"vue-property-decorator\";\nimport Vue from 'vue';\nimport { UI } from \"@/lib/UI\"\nimport { OpenDocument } from \"@/lib/core/Document\"\n\n@Component({name: \"OpenSheet\"})\nexport default class OpenSheet extends Vue {\n  private ui!: UI\n\n  execute(command: string, args?: any) {\n    this.ui.execCmd(command, args)\n  }\n\n  mounted() {\n    this.ui = new UI(<HTMLElement>this.$refs['canvas-container']);\n    this.$emit('ready', this.ui);\n    this.ui.addOnChangeEventListener((doc: OpenDocument) => {\n      this.$emit('change', doc);\n    })\n\n    // $('#merge-action').click(function () { return ui.execCmd(ui.isMerged ? 'unmerge' : 'merge'); });\n    // $('#left-action').click(function () { return ui.execCmd('align', 'left'); });\n    // $('#center-action').click(function () { return ui.execCmd('align', 'center'); });\n    // $('#right-action').click(function () { return ui.execCmd('align', 'right'); });\n    // $('#top-border-action').click(function () { return ui.execCmd('top-border', $('#border-color').val()); });\n    // $('#left-border-action').click(function () { return ui.execCmd('left-border', $('#border-color').val()); });\n    // $('#cross-border-action').click(function () { return ui.execCmd('cross-border', $('#border-color').val()); });\n    // $('#horizontal-border-action').click(function () { return ui.execCmd('horizontal-border', $('#border-color').val()); });\n    // $('#vertical-border-action').click(function () { return ui.execCmd('vertical-border', $('#border-color').val()); });\n    // $('#right-border-action').click(function () { return ui.execCmd('right-border', $('#border-color').val()); });\n    // $('#bottom-border-action').click(function () { return ui.execCmd('bottom-border', $('#border-color').val()); });\n    // $('#border-grid .all').click(function () { return ui.execCmd('full-border', $('#border-color').val()); });\n    // $('#no-border').click(function () { return ui.execCmd('no-border', '#fafafa'); });\n\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./OpenSheet.vue?vue&type=template&id=7e3de4f0&scoped=true&\"\nimport script from \"./OpenSheet.vue?vue&type=script&lang=ts&\"\nexport * from \"./OpenSheet.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./OpenSheet.vue?vue&type=style&index=0&id=7e3de4f0&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7e3de4f0\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\"Sheets1 | Sheet 2 | Sheet 3\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>Sheets1 | Sheet 2 | Sheet 3</div>\n</template>\n\n<script>\n  export default {\n    name: \"SheetSelector\"\n  }\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SheetSelector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SheetSelector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SheetSelector.vue?vue&type=template&id=3c0f1833&scoped=true&\"\nimport script from \"./SheetSelector.vue?vue&type=script&lang=js&\"\nexport * from \"./SheetSelector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3c0f1833\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"status-bar\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nexport default {\n  name: \"StatusBar\"\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StatusBar.vue?vue&type=template&id=5f93eeec&scoped=true&\"\nimport script from \"./StatusBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./StatusBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./StatusBar.vue?vue&type=style&index=0&id=5f93eeec&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5f93eeec\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport RibbonMenu from \"@/RibbonMenu.vue\"\nimport FormulaBar from \"@/FormulaBar.vue\"\nimport OpenSheet from \"@/OpenSheet.vue\"\nimport SheetSelector from \"@/SheetSelector.vue\"\nimport StatusBar from \"@/StatusBar.vue\"\nimport { OpenDocument } from \"@/lib/core/Document\"\nimport { UI } from \"@/lib/UI\"\nimport { Appearance } from \"@/lib/core/Appearance\"\n\n@Component({\n  components: {\n    StatusBar,\n    SheetSelector,\n    OpenSheet,\n    FormulaBar,\n    RibbonMenu,\n  },\n})\nexport default class App extends Vue {\n  private uiManager!: UI\n  private appearance: Appearance = new Appearance()\n  private state = {\n    isMerged: false,\n    label: 'A1',\n    value: null,\n    originalValue: null\n  }\n\n  onReady(ui: UI) {\n    this.uiManager = ui\n  }\n\n  onChange(doc: OpenDocument) {\n    this.appearance = doc.ActiveSheet.SelectedAppearance;\n    this.state.isMerged = this.uiManager.isMerged\n    this.state.label = doc.ActiveSheet.SelectionLabel\n    this.state.value = doc.ActiveSheet.SelectedValue\n    this.state.originalValue = doc.ActiveSheet.SelectedValue\n  }\n\n  onCommit() {\n    if (this.state.value != this.state.originalValue) {\n      this.uiManager.execCmd('change-value', null, null, this.state.value);\n    }\n  }\n\n  onAbort() {\n    this.state.value = this.state.originalValue\n  }\n\n  onAction({actionName, args}: { actionName: string, args: any }) {\n    if (actionName === 'save-ows') {\n      this.onSave()\n      return\n    } else if (actionName === 'load-ows') {\n      this.onLoad()\n      return\n    }\n    this.uiManager.execCmd(actionName, args)\n  }\n\n  onLoad() {\n    const win = <any>window;\n    const ui = this.uiManager\n\n    if (win.File && win.FileReader && win.FileList && win.Blob) {\n      let f = document.createElement('input');\n      f.type = 'file';\n      f.accept = '.ows';\n      f.addEventListener('change', function (evt: any) {\n        let file = evt.target['files'][0];\n        let reader = new FileReader();\n        reader.addEventListener('load', function (loadEvt: any) {\n          const rawData = loadEvt.target['result']\n          ui.load(rawData);\n        });\n        reader.readAsText(file, 'utf8');\n      });\n      f.click();\n    } else {\n      alert('The File APIs are not fully supported in this browser.');\n    }\n  }\n\n  onSave() {\n    const content = this.uiManager.save();\n    const uriContent = \"data:application/octet-stream,\" + encodeURIComponent(content);\n    let a = document.createElement(\"a\");\n    a['download'] = \"document.ows\";\n    a.href = uriContent;\n    a.target = \"_blank\";\n    a.click();\n  }\n\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=d5f48e8c&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* tslint:disable:no-console */\n\nimport { register } from 'register-service-worker';\n\nif (process.env.NODE_ENV === 'production') {\n  register(`service-worker.js`, {\n    ready() {\n      console.log(\n        'App is being served from cache by a service worker.\\n' +\n        'For more details, visit https://goo.gl/AFskqB',\n      );\n    },\n    registered() {\n      console.log('Service worker has been registered.');\n    },\n    cached() {\n      console.log('Content has been cached for offline use.');\n    },\n    updatefound() {\n      console.log('New content is downloading.');\n    },\n    updated() {\n      console.log('New content is available; please refresh.');\n    },\n    offline() {\n      console.log('No internet connection found. App is running in offline mode.');\n    },\n    error(error) {\n      console.error('Error during service worker registration:', error);\n    },\n  });\n}\n","import Vue from 'vue';\nimport App from './App.vue';\nimport './registerServiceWorker';\n\nVue.config.productionTip = false;\n\nnew Vue({\n  render: (h) => h(App),\n}).$mount('#app');\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=style&index=0&id=5f93eeec&lang=scss&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=style&index=0&id=5f93eeec&lang=scss&scoped=true&\""],"sourceRoot":""}